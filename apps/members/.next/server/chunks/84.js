"use strict";exports.id=84,exports.ids=[84],exports.modules={2378:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a){if(!(a instanceof Uint8Array)||a.length<8)throw new d.JWEInvalid("PBES2 Salt Input must be 8 or more octets")};let d=c(15860)},2601:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}resetStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/discovery/email/reset/start",headers:{},data:a})}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/discovery/email/reset",headers:{},data:a})}}b.Email=e},3016:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Rules=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}set(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/rules/set",baseURLType:"FRAUD",headers:{},data:a})}list(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/rules/list",baseURLType:"FRAUD",headers:{},data:a})}}b.Rules=e},5436:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.compactDecrypt=g;let d=c(12754),e=c(15860),f=c(49616);async function g(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:g,1:h,2:i,3:j,4:k,length:l}=a.split(".");if(5!==l)throw new e.JWEInvalid("Invalid Compact JWE");let m=await (0,d.flattenedDecrypt)({ciphertext:j,iv:i||void 0,protected:g,tag:k||void 0,encrypted_key:h||void 0},b,c),n={plaintext:m.plaintext,protectedHeader:m.protectedHeader};return"function"==typeof b?{...n,key:m.key}:n}},8237:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SamlShieldClient=b.SamlShield=void 0;var d=c(60817),e=c(65465);c(10682);class f{constructor(a){this.fetchConfig=a}async validate(a){let b,c,d=new URL("/v1/saml/validate",this.fetchConfig.baseURL);try{let c=new URLSearchParams;c.append("SAMLResponse",a.SAMLResponse),b=await fetch(d.toString(),{method:"POST",body:c,cache:"no-store",...this.fetchConfig,headers:this.fetchConfig.headers})}catch(b){throw new e.RequestError(b.message,{url:d.toString(),method:"POST",headers:this.fetchConfig.headers,data:a})}try{c=await b.json()}catch(b){throw new e.RequestError(`Unable to parse JSON response from server: ${b.message}`,{url:d.toString(),method:"POST",headers:this.fetchConfig.headers,data:a})}if(b.status>=400)throw new e.StytchError(c);return c}}b.SamlShield=f;class g extends d.BaseClient{constructor(a){if("object"!=typeof a)throw Error("Unexpected config type. Refer to https://github.com/stytchauth/stytch-node for how to use the Node client library.");if(!a.public_token)throw Error('Missing "public_token" in config');super({project_id:a.public_token,secret:"saml-shield-placeholder",timeout:a.timeout,dispatcher:a.dispatcher,custom_base_url:a.custom_base_url||"https://api.samlshield.com"}),this.fetchConfig.headers={"Content-Type":"application/x-www-form-urlencoded","User-Agent":this.fetchConfig.headers["User-Agent"],Authorization:"Bearer "+a.public_token},this.saml=new f(this.fetchConfig)}}b.SamlShieldClient=g},8414:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/magic_links/email/discovery/send",headers:{},data:a})}}b.Discovery=e},8828:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=c(77598).timingSafeEqual},10496:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598),e=c(33493),f=c(81078),g=c(49616),h=c(15860),i=c(8828),j=c(43916),k=c(28622),l=c(92749),m=c(58515),n=c(53738),o=c(61957),p=c(59091);b.default=(a,b,c,q,r,s)=>{let t;if((0,k.isCryptoKey)(b))(0,l.checkEncCryptoKey)(b,a,"decrypt"),t=d.KeyObject.from(b);else if(b instanceof Uint8Array||(0,m.default)(b))t=b;else throw TypeError((0,n.default)(b,...p.types,"Uint8Array"));if(!q)throw new h.JWEInvalid("JWE Initialization Vector missing");if(!r)throw new h.JWEInvalid("JWE Authentication Tag missing");switch((0,f.default)(a,t),(0,e.default)(a,q),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f,k){let l,n,p=parseInt(a.slice(1,4),10);(0,m.default)(b)&&(b=b.export());let q=b.subarray(p>>3),r=b.subarray(0,p>>3),s=parseInt(a.slice(-3),10),t=`aes-${p}-cbc`;if(!(0,o.default)(t))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let u=(0,j.default)(k,e,c,s,r,p);try{l=(0,i.default)(f,u)}catch{}if(!l)throw new h.JWEDecryptionFailed;try{let a=(0,d.createDecipheriv)(t,q,e);n=(0,g.concat)(a.update(c),a.final())}catch{}if(!n)throw new h.JWEDecryptionFailed;return n}(a,t,c,q,r,s);case"A128GCM":case"A192GCM":case"A256GCM":var u=t;let v=parseInt(a.slice(1,4),10),w=`aes-${v}-gcm`;if(!(0,o.default)(w))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);try{let a=(0,d.createDecipheriv)(w,u,q,{authTagLength:16});a.setAuthTag(r),s.byteLength&&a.setAAD(s,{plaintextLength:c.length});let b=a.update(c);return a.final(),b}catch{throw new h.JWEDecryptionFailed}default:throw new h.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},10682:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.addAuthorizationHeaders=function(a,b){b.session_token&&(a["X-Stytch-Member-Session"]=b.session_token),b.session_jwt&&(a["X-Stytch-Member-SessionJWT"]=b.session_jwt)}},11669:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.IDP=void 0;var d=i(c(57398));c(10682);var e=c(11753),f=c(65465),g=c(62872),h=c(86112);function i(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(i=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}class j{constructor(a,b,c){this.fetchConfig=a,this.oauth=new e.OAuth(this.fetchConfig),this.jwksClient=b.jwks,this.jwtOptions={audience:b.projectID,issuer:b.issuers,typ:"JWT"},this.policyCache=c}async introspectTokenNetwork(a,b){let c,d={...this.fetchConfig,headers:{"User-Agent":this.fetchConfig.headers["User-Agent"],"Content-Type":"application/x-www-form-urlencoded"}},e={token:a.token,client_id:a.client_id};a.client_secret&&a.client_secret.length>0&&(e.client_secret=a.client_secret),a.token_type_hint&&a.token_type_hint.length>0&&(e.token_type_hint=a.token_type_hint);try{c=await (0,h.request)(d,{method:"POST",url:`/v1/public/${this.jwtOptions.audience}/oauth2/introspect`,dataRaw:new URLSearchParams(e)})}catch(a){throw new f.ClientError("token_invalid","Could not introspect token",a)}if(!c.active)throw new f.ClientError("token_invalid","Token was not active",null);let{aud:i,exp:j,iat:k,iss:l,nbf:m,sub:n,status_code:o,scope:p,active:q,request_id:r,token_type:s,client_id:t,...u}=c;if(b?.authorization_check){let a=await this.policyCache.getPolicy();(0,g.performScopeAuthorizationCheck)({policy:a,tokenScopes:p.trim().split(" "),authorizationCheck:b.authorization_check})}return{subject:n,scope:p,audience:i,expires_at:j,issued_at:k,issuer:l,not_before:m,custom_claims:u,token_type:s}}async introspectTokenLocal(a,b){let c,e=b?.current_date||new Date;try{c=(await d.jwtVerify(a,this.jwksClient,{...this.jwtOptions,clockTolerance:b?.clock_tolerance_seconds,currentDate:e})).payload}catch(a){throw new f.ClientError("jwt_invalid","Could not verify JWT",a)}let{aud:h,exp:i,iat:j,iss:k,jti:l,nbf:m,sub:n,scope:o,...p}=c;if(b?.authorization_check){let a=await this.policyCache.getPolicy();(0,g.performScopeAuthorizationCheck)({policy:a,tokenScopes:o.trim().split(" "),authorizationCheck:b.authorization_check})}return{subject:n,expires_at:i,audience:h,issued_at:j,issuer:k,not_before:m,scope:o,token_type:"access_token",custom_claims:p}}}b.IDP=j},11674:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.FlattenedEncrypt=void 0;let d=c(16165),e=c(85167),f=c(72396),g=c(63001),h=c(15860),i=c(50215),j=c(49616),k=c(61801);class l{_plaintext;_protectedHeader;_sharedUnprotectedHeader;_unprotectedHeader;_aad;_cek;_iv;_keyManagementParameters;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=a}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}async encrypt(a,b){let c,l,m,n,o;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new h.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,i.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new h.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let p={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,k.default)(h.JWEInvalid,new Map,b?.crit,this._protectedHeader,p),void 0!==p.zip)throw new h.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:q,enc:r}=p;if("string"!=typeof q||!q)throw new h.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof r||!r)throw new h.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this._cek&&("dir"===q||"ECDH-ES"===q))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${q}`);{let d;({cek:l,encryptedKey:c,parameters:d}=await (0,g.default)(q,r,a,this._cek,this._keyManagementParameters)),d&&(b&&e.unprotected in b?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...d}:this.setUnprotectedHeader(d):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...d}:this.setProtectedHeader(d))}n=this._protectedHeader?j.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):j.encoder.encode(""),this._aad?(o=(0,d.encode)(this._aad),m=(0,j.concat)(n,j.encoder.encode("."),j.encoder.encode(o))):m=n;let{ciphertext:s,tag:t,iv:u}=await (0,f.default)(r,this._plaintext,l,this._iv,m),v={ciphertext:(0,d.encode)(s)};return u&&(v.iv=(0,d.encode)(u)),t&&(v.tag=(0,d.encode)(t)),c&&(v.encrypted_key=(0,d.encode)(c)),o&&(v.aad=o),this._protectedHeader&&(v.protected=j.decoder.decode(n)),this._sharedUnprotectedHeader&&(v.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(v.header=this._unprotectedHeader),v}}b.FlattenedEncrypt=l},11753:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OAuth=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authorizeStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/idp/oauth/authorize/start",headers:{},data:a})}authorize(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/idp/oauth/authorize",headers:{},data:a})}}b.OAuth=e},11883:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.bitLength=f;let d=c(15860),e=c(84518);function f(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}b.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},12470:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.generateSecret=e;let d=c(21806);async function e(a,b){return(0,d.generateSecret)(a,b)}},12714:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SSO=void 0;var d=c(10682),e=c(69354),f=c(39876),g=c(86112),h=c(36208);class i{constructor(a){this.fetchConfig=a,this.oidc=new f.OIDC(this.fetchConfig),this.saml=new h.SAML(this.fetchConfig),this.external=new e.External(this.fetchConfig)}getConnections(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/sso/${encodeURIComponent(a.organization_id)}`,headers:c,params:{}})}deleteConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/sso/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}`,headers:c,data:{}})}authenticate(a){return(0,g.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sso/authenticate",headers:{},data:a})}}b.SSO=i},12754:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.flattenedDecrypt=n;let d=c(16165),e=c(10496),f=c(15860),g=c(50215),h=c(17600),i=c(85733),j=c(49616),k=c(11883),l=c(61801),m=c(96591);async function n(a,b,c){let n,o,p,q,r,s,t;if(!(0,h.default)(a))throw new f.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new f.JWEInvalid("JOSE Header missing");if(void 0!==a.iv&&"string"!=typeof a.iv)throw new f.JWEInvalid("JWE Initialization Vector incorrect type");if("string"!=typeof a.ciphertext)throw new f.JWEInvalid("JWE Ciphertext missing or incorrect type");if(void 0!==a.tag&&"string"!=typeof a.tag)throw new f.JWEInvalid("JWE Authentication Tag incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new f.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new f.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new f.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,h.default)(a.header))throw new f.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,h.default)(a.unprotected))throw new f.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,d.decode)(a.protected);n=JSON.parse(j.decoder.decode(b))}catch{throw new f.JWEInvalid("JWE Protected Header is invalid")}if(!(0,g.default)(n,a.header,a.unprotected))throw new f.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...n,...a.header,...a.unprotected};if((0,l.default)(f.JWEInvalid,new Map,c?.crit,n,u),void 0!==u.zip)throw new f.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:v,enc:w}=u;if("string"!=typeof v||!v)throw new f.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof w||!w)throw new f.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let x=c&&(0,m.default)("keyManagementAlgorithms",c.keyManagementAlgorithms),y=c&&(0,m.default)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(x&&!x.has(v)||!x&&v.startsWith("PBES2"))throw new f.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(y&&!y.has(w))throw new f.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==a.encrypted_key)try{o=(0,d.decode)(a.encrypted_key)}catch{throw new f.JWEInvalid("Failed to base64url decode the encrypted_key")}let z=!1;"function"==typeof b&&(b=await b(n,a),z=!0);try{p=await (0,i.default)(v,b,o,u,c)}catch(a){if(a instanceof TypeError||a instanceof f.JWEInvalid||a instanceof f.JOSENotSupported)throw a;p=(0,k.default)(w)}if(void 0!==a.iv)try{q=(0,d.decode)(a.iv)}catch{throw new f.JWEInvalid("Failed to base64url decode the iv")}if(void 0!==a.tag)try{r=(0,d.decode)(a.tag)}catch{throw new f.JWEInvalid("Failed to base64url decode the tag")}let A=j.encoder.encode(a.protected??"");s=void 0!==a.aad?(0,j.concat)(A,j.encoder.encode("."),j.encoder.encode(a.aad)):A;try{t=(0,d.decode)(a.ciphertext)}catch{throw new f.JWEInvalid("Failed to base64url decode the ciphertext")}let B={plaintext:await (0,e.default)(w,p,t,q,r,s)};if(void 0!==a.protected&&(B.protectedHeader=n),void 0!==a.aad)try{B.additionalAuthenticatedData=(0,d.decode)(a.aad)}catch{throw new f.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(B.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(B.unprotectedHeader=a.header),z)?{...B,key:b}:B}},12806:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.calculateJwkThumbprint=j,b.calculateJwkThumbprintUri=k;let d=c(81841),e=c(16165),f=c(15860),g=c(49616),h=c(17600),i=(a,b)=>{if("string"!=typeof a||!a)throw new f.JWKInvalid(`${b} missing or invalid`)};async function j(a,b){let c;if(!(0,h.default)(a))throw TypeError("JWK must be an object");if("sha256"!==(b??="sha256")&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(a.kty){case"EC":i(a.crv,'"crv" (Curve) Parameter'),i(a.x,'"x" (X Coordinate) Parameter'),i(a.y,'"y" (Y Coordinate) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":i(a.crv,'"crv" (Subtype of Key Pair) Parameter'),i(a.x,'"x" (Public Key) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x};break;case"RSA":i(a.e,'"e" (Exponent) Parameter'),i(a.n,'"n" (Modulus) Parameter'),c={e:a.e,kty:a.kty,n:a.n};break;case"oct":i(a.k,'"k" (Key Value) Parameter'),c={k:a.k,kty:a.kty};break;default:throw new f.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let j=g.encoder.encode(JSON.stringify(c));return(0,e.encode)(await (0,d.default)(b,j))}async function k(a,b){b??="sha256";let c=await j(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}},13457:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/magic_links/discovery/authenticate",headers:{},data:a})}}b.Discovery=e},14010:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.IDP=void 0;var d=i(c(57398));c(10682);var e=c(86786),f=c(65465),g=c(96361),h=c(86112);function i(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(i=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}class j{constructor(a,b,c){this.fetchConfig=a,this.oauth=new e.OAuth(this.fetchConfig),this.jwksClient=b.jwks,this.jwtOptions={audience:b.projectID,issuer:b.issuers,typ:"JWT"},this.policyCache=c}async introspectTokenNetwork(a,b){let c,d={...this.fetchConfig,headers:{"User-Agent":this.fetchConfig.headers["User-Agent"],"Content-Type":"application/x-www-form-urlencoded"}},e={token:a.token,client_id:a.client_id};a.client_secret&&a.client_secret.length>0&&(e.client_secret=a.client_secret),a.token_type_hint&&a.token_type_hint.length>0&&(e.token_type_hint=a.token_type_hint);try{c=await (0,h.request)(d,{method:"POST",url:`/v1/public/${this.jwtOptions.audience}/oauth2/introspect`,dataRaw:new URLSearchParams(e)})}catch(a){throw new f.ClientError("token_invalid","Could not introspect token",a)}if(!c.active)throw new f.ClientError("token_invalid","Token was not active",null);let{aud:i,exp:j,iat:k,iss:l,nbf:m,sub:n,status_code:o,scope:p,active:q,request_id:r,token_type:s,client_id:t,"https://stytch.com/organization":u,...v}=c;if(b?.authorization_check){let a=await this.policyCache.getPolicy(),c=u.organization_id;(0,g.performScopeAuthorizationCheck)({policy:a,subjectOrgID:c,tokenScopes:p.trim().split(" "),authorizationCheck:b.authorization_check})}return{subject:n,scope:p,audience:i,expires_at:j,issued_at:k,issuer:l,not_before:m,token_type:s,organization:{organization_id:u.organization_id,slug:u.slug},custom_claims:v}}async introspectTokenLocal(a,b){let c,e=b?.current_date||new Date;try{c=(await d.jwtVerify(a,this.jwksClient,{...this.jwtOptions,clockTolerance:b?.clock_tolerance_seconds,currentDate:e})).payload}catch(a){throw new f.ClientError("jwt_invalid","Could not verify JWT",a)}let{aud:h,exp:i,iat:j,iss:k,jti:l,nbf:m,sub:n,scope:o,"https://stytch.com/organization":p,...q}=c;if(b?.authorization_check){let a=await this.policyCache.getPolicy();(0,g.performScopeAuthorizationCheck)({policy:a,subjectOrgID:p.organization_id,tokenScopes:o.trim().split(" "),authorizationCheck:b.authorization_check})}return{subject:n,expires_at:i,audience:h,issued_at:j,issuer:k,not_before:m,scope:o,token_type:"access_token",organization:{organization_id:p.organization_id,slug:p.slug},custom_claims:q}}}b.IDP=j},14061:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Debug=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}whoami(){return(0,d.request)(this.fetchConfig,{method:"GET",url:"/v1/debug/whoami",headers:{}})}}b.Debug=e},15267:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ExistingPassword=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/existing_password/reset",headers:{},data:a})}}b.ExistingPassword=e},15860:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.JWSSignatureVerificationFailed=b.JWKSTimeout=b.JWKSMultipleMatchingKeys=b.JWKSNoMatchingKey=b.JWKSInvalid=b.JWKInvalid=b.JWTInvalid=b.JWSInvalid=b.JWEInvalid=b.JWEDecryptionFailed=b.JOSENotSupported=b.JOSEAlgNotAllowed=b.JWTExpired=b.JWTClaimValidationFailed=b.JOSEError=void 0;class c extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(a,b){super(a,b),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}b.JOSEError=c;class d extends c{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}b.JWTClaimValidationFailed=d;class e extends c{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}b.JWTExpired=e;class f extends c{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}b.JOSEAlgNotAllowed=f;class g extends c{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}b.JOSENotSupported=g;class h extends c{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(a="decryption operation failed",b){super(a,b)}}b.JWEDecryptionFailed=h;class i extends c{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}b.JWEInvalid=i;class j extends c{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}b.JWSInvalid=j;class k extends c{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}b.JWTInvalid=k;class l extends c{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}b.JWKInvalid=l;class m extends c{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}b.JWKSInvalid=m;class n extends c{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(a="no applicable key found in the JSON Web Key Set",b){super(a,b)}}b.JWKSNoMatchingKey=n;class o extends c{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(a="multiple matching keys found in the JSON Web Key Set",b){super(a,b)}}b.JWKSMultipleMatchingKeys=o;class p extends c{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(a="request timed out",b){super(a,b)}}b.JWKSTimeout=p;class q extends c{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(a="signature verification failed",b){super(a,b)}}b.JWSSignatureVerificationFailed=q},16165:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decode=b.encode=b.encodeBase64=b.decodeBase64=void 0;let d=c(4573),e=c(49616);b.encode=a=>d.Buffer.from(a).toString("base64url"),b.decodeBase64=a=>new Uint8Array(d.Buffer.from(a,"base64")),b.encodeBase64=a=>d.Buffer.from(a).toString("base64"),b.decode=a=>{let b;return new Uint8Array(d.Buffer.from(((b=a)instanceof Uint8Array&&(b=e.decoder.decode(b)),b),"base64url"))}},17070:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Impersonation=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/impersonation/authenticate",headers:{},data:a})}}b.Impersonation=e},17600:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}},18166:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Users=b.UserSearchIterator=void 0,c(10682);var d,e=c(86112),f=((d=f||{})[d.pending=0]="pending",d[d.inProgress=1]="inProgress",d[d.complete=2]="complete",d);class g{constructor(a,b){this.client=a,this.data=b,this.mode=f.pending}async next(){let a=await this.client.search(this.data);return this.data={...this.data,cursor:a.results_metadata.next_cursor},this.data.cursor?this.mode=f.inProgress:this.mode=f.complete,a.results}hasNext(){return this.mode!==f.complete}async *[Symbol.asyncIterator](){for(;this.hasNext();)yield this.next()}}b.UserSearchIterator=g;class h{constructor(a){this.fetchConfig=a}create(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/users",headers:{},data:a})}get(a){return(0,e.request)(this.fetchConfig,{method:"GET",url:`/v1/users/${encodeURIComponent(a.user_id)}`,headers:{},params:{}})}search(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/users/search",headers:{},data:a})}update(a){return(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/users/${encodeURIComponent(a.user_id)}`,headers:{},data:{name:a.name,attributes:a.attributes,trusted_metadata:a.trusted_metadata,untrusted_metadata:a.untrusted_metadata,external_id:a.external_id,roles:a.roles}})}exchangePrimaryFactor(a){return(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/users/${encodeURIComponent(a.user_id)}/exchange_primary_factor`,headers:{},data:{email_address:a.email_address,phone_number:a.phone_number}})}delete(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/${encodeURIComponent(a.user_id)}`,headers:{},data:{}})}deleteEmail(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/emails/${encodeURIComponent(a.email_id)}`,headers:{},data:{}})}deletePhoneNumber(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/phone_numbers/${encodeURIComponent(a.phone_id)}`,headers:{},data:{}})}deleteWebAuthnRegistration(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/webauthn_registrations/${encodeURIComponent(a.webauthn_registration_id)}`,headers:{},data:{}})}deleteBiometricRegistration(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/biometric_registrations/${encodeURIComponent(a.biometric_registration_id)}`,headers:{},data:{}})}deleteTOTP(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/totps/${encodeURIComponent(a.totp_id)}`,headers:{},data:{}})}deleteCryptoWallet(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/crypto_wallets/${encodeURIComponent(a.crypto_wallet_id)}`,headers:{},data:{}})}deletePassword(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/passwords/${encodeURIComponent(a.password_id)}`,headers:{},data:{}})}deleteOAuthRegistration(a){return(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/users/oauth/${encodeURIComponent(a.oauth_user_registration_id)}`,headers:{},data:{}})}connectedApps(a){return(0,e.request)(this.fetchConfig,{method:"GET",url:`/v1/users/${encodeURIComponent(a.user_id)}/connected_apps`,headers:{},params:{}})}revoke(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/users/${encodeURIComponent(a.user_id)}/connected_apps/${encodeURIComponent(a.connected_app_id)}/revoke`,headers:{},data:{}})}searchAll(a){return new g(this,a)}}b.Users=h},18681:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.importSPKI=i,b.importX509=j,b.importPKCS8=k,b.importJWK=l;let d=c(16165),e=c(50452),f=c(35725),g=c(15860),h=c(17600);async function i(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,e.fromSPKI)(a,b,c)}async function j(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,e.fromX509)(a,b,c)}async function k(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,e.fromPKCS8)(a,b,c)}async function l(a,b){if(!(0,h.default)(a))throw TypeError("JWK must be an object");switch(b||=a.alg,a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');return(0,d.decode)(a.k);case"RSA":if("oth"in a&&void 0!==a.oth)throw new g.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,f.default)({...a,alg:b});default:throw new g.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}},21204:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Organizations=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}create(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/discovery/organizations/create",headers:{},data:a})}list(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/discovery/organizations",headers:{},data:a})}}b.Organizations=e},21726:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0});let c=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;b.default=a=>{let b,d=c.exec(a);if(!d||d[4]&&d[1])throw TypeError("Invalid time period format");let e=parseFloat(d[2]);switch(d[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":b=Math.round(e);break;case"minute":case"minutes":case"min":case"mins":case"m":b=Math.round(60*e);break;case"hour":case"hours":case"hr":case"hrs":case"h":b=Math.round(3600*e);break;case"day":case"days":case"d":b=Math.round(86400*e);break;case"week":case"weeks":case"w":b=Math.round(604800*e);break;default:b=Math.round(0x1e187e0*e)}return"-"===d[1]||"ago"===d[4]?-b:b}},21806:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.generateSecret=i,b.generateKeyPair=j;let d=c(77598),e=c(57975),f=c(84518),g=c(15860),h=(0,e.promisify)(d.generateKeyPair);async function i(a,b){let c;switch(a){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new g.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,d.createSecretKey)((0,f.default)(new Uint8Array(c>>3)))}async function j(a,b){switch(a){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let a=b?.modulusLength??2048;if("number"!=typeof a||a<2048)throw new g.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return await h("rsa",{modulusLength:a,publicExponent:65537})}case"ES256":return h("ec",{namedCurve:"P-256"});case"ES256K":return h("ec",{namedCurve:"secp256k1"});case"ES384":return h("ec",{namedCurve:"P-384"});case"ES512":return h("ec",{namedCurve:"P-521"});case"Ed25519":return h("ed25519");case"EdDSA":switch(b?.crv){case void 0:case"Ed25519":return h("ed25519");case"Ed448":return h("ed448");default:throw new g.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let a=b?.crv??"P-256";switch(a){case void 0:case"P-256":case"P-384":case"P-521":return h("ec",{namedCurve:a});case"X25519":return h("x25519");case"X448":return h("x448");default:throw new g.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}}default:throw new g.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}},22200:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sessions=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/session/reset",headers:{},data:a})}}b.Sessions=e},22725:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ecdhAllowed=void 0,b.deriveKey=o,b.generateEpk=p;let d=c(77598),e=c(57975),f=c(26127),g=c(49616),h=c(15860),i=c(28622),j=c(92749),k=c(58515),l=c(53738),m=c(59091),n=(0,e.promisify)(d.generateKeyPair);async function o(a,b,c,e,f=new Uint8Array(0),h=new Uint8Array(0)){let n,p;if((0,i.isCryptoKey)(a))(0,j.checkEncCryptoKey)(a,"ECDH"),n=d.KeyObject.from(a);else if((0,k.default)(a))n=a;else throw TypeError((0,l.default)(a,...m.types));if((0,i.isCryptoKey)(b))(0,j.checkEncCryptoKey)(b,"ECDH","deriveBits"),p=d.KeyObject.from(b);else if((0,k.default)(b))p=b;else throw TypeError((0,l.default)(b,...m.types));let q=(0,g.concat)((0,g.lengthAndInput)(g.encoder.encode(c)),(0,g.lengthAndInput)(f),(0,g.lengthAndInput)(h),(0,g.uint32be)(e)),r=(0,d.diffieHellman)({privateKey:p,publicKey:n});return(0,g.concatKdf)(r,e,q)}async function p(a){let b;if((0,i.isCryptoKey)(a))b=d.KeyObject.from(a);else if((0,k.default)(a))b=a;else throw TypeError((0,l.default)(a,...m.types));switch(b.asymmetricKeyType){case"x25519":return n("x25519");case"x448":return n("x448");case"ec":return n("ec",{namedCurve:(0,f.default)(b)});default:throw new h.JOSENotSupported("Invalid or unsupported EPK")}}b.ecdhAllowed=a=>["P-256","P-384","P-521","X25519","X448"].includes((0,f.default)(a))},24655:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MagicLinks=void 0,c(10682);var d=c(46144),e=c(86112);class f{constructor(a){this.fetchConfig=a,this.email=new d.Email(this.fetchConfig)}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links/authenticate",headers:{},data:a})}create(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links",headers:{},data:a})}}b.MagicLinks=f},25064:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.CompactEncrypt=void 0;let d=c(11674);class e{_flattened;constructor(a){this._flattened=new d.FlattenedEncrypt(a)}setContentEncryptionKey(a){return this._flattened.setContentEncryptionKey(a),this}setInitializationVector(a){return this._flattened.setInitializationVector(a),this}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}setKeyManagementParameters(a){return this._flattened.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this._flattened.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}b.CompactEncrypt=e},26127:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.weakMap=void 0;let d=c(77598),e=c(15860),f=c(28622),g=c(58515),h=c(53738),i=c(59091),j=c(44631);b.weakMap=new WeakMap,b.default=(a,b)=>{let c;if((0,f.isCryptoKey)(a))c=d.KeyObject.from(a);else if((0,g.default)(a))c=a;else if((0,j.isJWK)(a))return a.crv;else throw TypeError((0,h.default)(a,...i.types));if("secret"===c.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(c.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${c.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${c.asymmetricKeyType.slice(1)}`;case"ec":{let a=c.asymmetricKeyDetails.namedCurve;if(b)return a;switch(a){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new e.JOSENotSupported("Unsupported key curve for this operation")}}default:throw TypeError("Invalid asymmetric key type for this operation")}}},26279:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decrypt=b.encrypt=void 0;let d=c(57975),e=c(77598),f=c(84518),g=c(49616),h=c(16165),i=c(63400),j=c(2378),k=c(28622),l=c(92749),m=c(58515),n=c(53738),o=c(59091),p=(0,d.promisify)(e.pbkdf2);function q(a,b){if((0,m.default)(a))return a.export();if(a instanceof Uint8Array)return a;if((0,k.isCryptoKey)(a))return(0,l.checkEncCryptoKey)(a,b,"deriveBits","deriveKey"),e.KeyObject.from(a).export();throw TypeError((0,n.default)(a,...o.types,"Uint8Array"))}b.encrypt=async(a,b,c,d=2048,e=(0,f.default)(new Uint8Array(16)))=>{(0,j.default)(e);let k=(0,g.p2s)(a,e),l=parseInt(a.slice(13,16),10)>>3,m=q(b,a),n=await p(m,k,d,l,`sha${a.slice(8,11)}`);return{encryptedKey:await (0,i.wrap)(a.slice(-6),n,c),p2c:d,p2s:(0,h.encode)(e)}},b.decrypt=async(a,b,c,d,e)=>{(0,j.default)(e);let f=(0,g.p2s)(a,e),h=parseInt(a.slice(13,16),10)>>3,k=q(b,a),l=await p(k,f,d,h,`sha${a.slice(8,11)}`);return(0,i.unwrap)(a.slice(-6),l,c)}},26777:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.generalDecrypt=g;let d=c(12754),e=c(15860),f=c(17600);async function g(a,b,c){if(!(0,f.default)(a))throw new e.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(f.default))throw new e.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new e.JWEInvalid("JWE Recipients has no members");for(let e of a.recipients)try{return await (0,d.flattenedDecrypt)({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:e.encrypted_key,header:e.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new e.JWEDecryptionFailed}},26976:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Passwords=void 0,c(10682);var d=c(58071),e=c(68164),f=c(86112),g=c(62043);class h{constructor(a){this.fetchConfig=a,this.email=new d.Email(this.fetchConfig),this.existingPassword=new e.ExistingPassword(this.fetchConfig),this.sessions=new g.Sessions(this.fetchConfig)}create(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords",headers:{},data:a})}authenticate(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/authenticate",headers:{},data:a})}strengthCheck(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/strength_check",headers:{},data:a})}migrate(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/migrate",headers:{},data:a})}}b.Passwords=h},27566:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.UnsecuredJWT=void 0;let d=c(16165),e=c(49616),f=c(15860),g=c(79648),h=c(39004);class i extends h.ProduceJWT{encode(){let a=d.encode(JSON.stringify({alg:"none"})),b=d.encode(JSON.stringify(this._payload));return`${a}.${b}.`}static decode(a,b){let c;if("string"!=typeof a)throw new f.JWTInvalid("Unsecured JWT must be a string");let{0:h,1:i,2:j,length:k}=a.split(".");if(3!==k||""!==j)throw new f.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(e.decoder.decode(d.decode(h))),"none"!==c.alg)throw Error()}catch{throw new f.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,g.default)(c,d.decode(i),b),header:c}}}b.UnsecuredJWT=i},27931:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decrypt=b.encrypt=void 0;let d=c(77598),e=c(57975),f=c(35884),g=c(28622),h=c(92749),i=c(58515),j=c(53738),k=c(59091),l=(a,b)=>{if("rsa"!==a.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,f.default)(a,b)},m=(0,e.deprecate)(()=>d.constants.RSA_PKCS1_PADDING,'The RSA1_5 "alg" (JWE Algorithm) is deprecated and will be removed in the next major revision.'),n=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return d.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return m();default:return}},o=a=>{switch(a){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function p(a,b,...c){if((0,i.default)(a))return a;if((0,g.isCryptoKey)(a))return(0,h.checkEncCryptoKey)(a,b,...c),d.KeyObject.from(a);throw TypeError((0,j.default)(a,...k.types))}b.encrypt=(a,b,c)=>{let e=n(a),f=o(a),g=p(b,a,"wrapKey","encrypt");return l(g,a),(0,d.publicEncrypt)({key:g,oaepHash:f,padding:e},c)},b.decrypt=(a,b,c)=>{let e=n(a),f=o(a),g=p(b,a,"unwrapKey","decrypt");return l(g,a),(0,d.privateDecrypt)({key:g,oaepHash:f,padding:e},c)}},28400:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.VerdictReasons=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}override(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/verdict_reasons/override",baseURLType:"FRAUD",headers:{},data:a})}list(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/verdict_reasons/list",baseURLType:"FRAUD",headers:{},data:a})}}b.VerdictReasons=e},28622:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.isCryptoKey=void 0;let d=c(77598),e=c(57975);b.default=d.webcrypto,b.isCryptoKey=a=>e.types.isCryptoKey(a)},28816:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ConnectedApps=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}revoke(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/connected_apps/${encodeURIComponent(a.connected_app_id)}/revoke`,headers:c,data:{}})}}b.ConnectedApps=f},29088:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.CryptoWallets=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authenticateStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/crypto_wallets/authenticate/start",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/crypto_wallets/authenticate",headers:{},data:a})}}b.CryptoWallets=e},29316:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.M2M=void 0,c(10682);var d=c(66575),e=c(93383),f=c(65465),g=c(82208),h=c(86112);class i{constructor(a,b){this.fetchConfig=a,this.clients=new d.Clients(this.fetchConfig),this.jwksClient=b.jwks,this.jwtOptions={audience:b.projectID,issuer:b.issuers,typ:"JWT"}}async token(a){let b={...this.fetchConfig,headers:{"User-Agent":this.fetchConfig.headers["User-Agent"],"Content-Type":"application/x-www-form-urlencoded"}},c={client_id:a.client_id,client_secret:a.client_secret,grant_type:"client_credentials"};return a.scopes&&a.scopes.length>0&&(c.scope=a.scopes?.join(" ")),(0,h.request)(b,{method:"POST",url:`/v1/public/${this.jwtOptions.audience}/oauth2/token`,dataRaw:new URLSearchParams(c)})}async authenticateToken(a,b=g.performAuthorizationCheck){let{sub:c,scope:d,custom_claims:h}=await (0,e.authenticateM2MJwtLocal)(this.jwksClient,this.jwtOptions,a.access_token,{max_token_age_seconds:a.max_token_age_seconds,clock_tolerance_seconds:a.clock_tolerance_seconds}),i=d.split(" ");if(a.required_scopes&&a.required_scopes.length>0&&!b({hasScopes:i,requiredScopes:a.required_scopes}))throw new f.ClientError("missing_scopes","Missing at least one required scope",a.required_scopes);return{client_id:c,scopes:i,custom_claims:h}}}b.M2M=i},29931:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Whatsapp=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/whatsapp/send",headers:{},data:a})}loginOrCreate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/whatsapp/login_or_create",headers:{},data:a})}}b.Whatsapp=e},30238:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.B2BClient=void 0;var d=A(c(57398)),e=c(60817),f=c(79652),g=c(14061),h=c(64271),i=c(87520),j=c(14010),k=c(55245),l=c(93383),m=c(29316),n=c(65200),o=c(34750),p=c(53629),q=c(86568),r=c(76119),s=c(96361),t=c(37147),u=c(68421),v=c(71979),w=c(48733),x=c(56604),y=c(12714),z=c(39019);function A(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(A=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}class B extends e.BaseClient{constructor(a){super(a),this.jwtConfig={projectID:a.project_id,jwks:d.createRemoteJWKSet(new URL(`/v1/b2b/sessions/jwks/${a.project_id}`,this.fetchConfig.baseURL)),issuers:[`stytch.com/${a.project_id}`,(0,l.trimTrailingSlash)(this.fetchConfig.baseURL)]};const b=new s.PolicyCache(new u.RBAC(this.fetchConfig));this.connectedApp=new f.ConnectedApp(this.fetchConfig),this.debug=new g.Debug(this.fetchConfig),this.discovery=new h.Discovery(this.fetchConfig),this.fraud=new i.Fraud(this.fetchConfig),this.idp=new j.IDP(this.fetchConfig,this.jwtConfig,b),this.impersonation=new k.Impersonation(this.fetchConfig),this.m2m=new m.M2M(this.fetchConfig,this.jwtConfig),this.magicLinks=new n.MagicLinks(this.fetchConfig),this.oauth=new o.OAuth(this.fetchConfig),this.otps=new q.OTPs(this.fetchConfig),this.organizations=new p.Organizations(this.fetchConfig),this.passwords=new r.Passwords(this.fetchConfig),this.project=new t.Project(this.fetchConfig),this.rbac=new u.RBAC(this.fetchConfig),this.recoveryCodes=new v.RecoveryCodes(this.fetchConfig),this.scim=new w.SCIM(this.fetchConfig),this.sso=new y.SSO(this.fetchConfig),this.sessions=new x.Sessions(this.fetchConfig,this.jwtConfig,b),this.totps=new z.TOTPs(this.fetchConfig)}}b.B2BClient=B},31075:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Fingerprint=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}lookup(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/fingerprint/lookup",baseURLType:"FRAUD",headers:{},data:a})}}b.Fingerprint=e},33349:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Members=void 0;var d=c(10682),e=c(28816),f=c(63896),g=c(86112);class h{constructor(a){this.fetchConfig=a,this.oauthProviders=new f.OAuthProviders(this.fetchConfig),this.connectedApps=new e.ConnectedApps(this.fetchConfig)}update(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}`,headers:c,data:{name:a.name,trusted_metadata:a.trusted_metadata,untrusted_metadata:a.untrusted_metadata,is_breakglass:a.is_breakglass,mfa_phone_number:a.mfa_phone_number,mfa_enrolled:a.mfa_enrolled,roles:a.roles,preserve_existing_sessions:a.preserve_existing_sessions,default_mfa_method:a.default_mfa_method,email_address:a.email_address,external_id:a.external_id,unlink_email:a.unlink_email}})}delete(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}`,headers:c,data:{}})}reactivate(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/reactivate`,headers:c,data:{}})}deleteMFAPhoneNumber(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/mfa_phone_numbers/${encodeURIComponent(a.member_id)}`,headers:c,data:{}})}deleteTOTP(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/totp`,headers:c,data:{}})}search(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/organizations/members/search",headers:c,data:a})}deletePassword(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/passwords/${encodeURIComponent(a.member_password_id)}`,headers:c,data:{}})}dangerouslyGet(a){return(0,g.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/members/dangerously_get/${encodeURIComponent(a.member_id)}`,headers:{},params:{include_deleted:a.include_deleted}})}oidcProviders(a){return(0,g.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oidc_providers`,headers:{},params:{include_refresh_token:a.include_refresh_token}})}unlinkRetiredEmail(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/unlink_retired_email`,headers:c,data:{email_id:a.email_id,email_address:a.email_address}})}startEmailUpdate(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/start_email_update`,headers:c,data:{email_address:a.email_address,login_redirect_url:a.login_redirect_url,locale:a.locale,login_template_id:a.login_template_id,delivery_method:a.delivery_method}})}getConnectedApps(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/connected_apps`,headers:c,params:{}})}create(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,g.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members`,headers:c,data:{email_address:a.email_address,name:a.name,trusted_metadata:a.trusted_metadata,untrusted_metadata:a.untrusted_metadata,create_member_as_pending:a.create_member_as_pending,is_breakglass:a.is_breakglass,mfa_phone_number:a.mfa_phone_number,mfa_enrolled:a.mfa_enrolled,roles:a.roles,external_id:a.external_id}})}get(a){return(0,g.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/member`,headers:{},params:{member_id:a.member_id,email_address:a.email_address}})}}b.Members=h},33493:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(15860),e=c(50263);b.default=(a,b)=>{if(b.length<<3!==(0,e.bitLength)(a))throw new d.JWEInvalid("Invalid Initialization Vector length")}},33860:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Connection=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}update(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}`,headers:c,data:{display_name:a.display_name,identity_provider:a.identity_provider,scim_group_implicit_role_assignments:a.scim_group_implicit_role_assignments}})}delete(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}`,headers:c,data:{}})}rotateStart(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}/rotate/start`,headers:c,data:{}})}rotateComplete(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}/rotate/complete`,headers:c,data:{}})}rotateCancel(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}/rotate/cancel`,headers:c,data:{}})}getGroups(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection/${encodeURIComponent(a.connection_id)}`,headers:c,params:{cursor:a.cursor,limit:a.limit}})}create(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection`,headers:c,data:{display_name:a.display_name,identity_provider:a.identity_provider}})}get(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/scim/${encodeURIComponent(a.organization_id)}/connection`,headers:c,params:{}})}}b.Connection=f},34750:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OAuth=void 0,c(10682);var d=c(90951),e=c(86112);class f{constructor(a){this.fetchConfig=a,this.discovery=new d.Discovery(this.fetchConfig)}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/oauth/authenticate",headers:{},data:a})}}b.OAuth=f},35327:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=a=>Math.floor(a.getTime()/1e3)},35725:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598);b.default=a=>a.d?(0,d.createPrivateKey)({format:"jwk",key:a}):(0,d.createPublicKey)({format:"jwk",key:a})},35884:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598);b.default=(a,b)=>{let c;try{c=a instanceof d.KeyObject?a.asymmetricKeyDetails?.modulusLength:Buffer.from(a.n,"base64url").byteLength<<3}catch{}if("number"!=typeof c||c<2048)throw TypeError(`${b} requires key modulusLength to be 2048 bits or larger`)}},36208:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SAML=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}createConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/sso/saml/${encodeURIComponent(a.organization_id)}`,headers:c,data:{display_name:a.display_name,identity_provider:a.identity_provider}})}updateConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/sso/saml/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}`,headers:c,data:{idp_entity_id:a.idp_entity_id,display_name:a.display_name,attribute_mapping:a.attribute_mapping,x509_certificate:a.x509_certificate,idp_sso_url:a.idp_sso_url,saml_connection_implicit_role_assignments:a.saml_connection_implicit_role_assignments,saml_group_implicit_role_assignments:a.saml_group_implicit_role_assignments,alternative_audience_uri:a.alternative_audience_uri,identity_provider:a.identity_provider,signing_private_key:a.signing_private_key,nameid_format:a.nameid_format,alternative_acs_url:a.alternative_acs_url,idp_initiated_auth_disabled:a.idp_initiated_auth_disabled,saml_encryption_private_key:a.saml_encryption_private_key,allow_gateway_callback:a.allow_gateway_callback}})}updateByURL(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/sso/saml/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}/url`,headers:c,data:{metadata_url:a.metadata_url}})}deleteVerificationCertificate(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/sso/saml/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}/verification_certificates/${encodeURIComponent(a.certificate_id)}`,headers:c,data:{}})}deleteEncryptionPrivateKey(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/sso/saml/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}/encryption_private_keys/${encodeURIComponent(a.private_key_id)}`,headers:c,data:{}})}}b.SAML=f},36759:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SignJWT=void 0;let d=c(98946),e=c(15860),f=c(49616),g=c(39004);class h extends g.ProduceJWT{_protectedHeader;setProtectedHeader(a){return this._protectedHeader=a,this}async sign(a,b){let c=new d.CompactSign(f.encoder.encode(JSON.stringify(this._payload)));if(c.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new e.JWTInvalid("JWTs MUST NOT use unencoded payload");return c.sign(a,b)}}b.SignJWT=h},37147:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Project=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}metrics(){return(0,d.request)(this.fetchConfig,{method:"GET",url:"/v1/projects/metrics",headers:{}})}}b.Project=e},37839:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Clients=void 0,c(10682);var d=c(86112),e=c(80413);class f{constructor(a){this.fetchConfig=a,this.secrets=new e.Secrets(this.fetchConfig)}get(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}`,headers:{},params:{}})}update(a){return(0,d.request)(this.fetchConfig,{method:"PUT",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}`,headers:{},data:{client_name:a.client_name,client_description:a.client_description,redirect_urls:a.redirect_urls,full_access_allowed:a.full_access_allowed,access_token_expiry_minutes:a.access_token_expiry_minutes,access_token_custom_audience:a.access_token_custom_audience,access_token_template_content:a.access_token_template_content,post_logout_redirect_urls:a.post_logout_redirect_urls,logo_url:a.logo_url,bypass_consent_for_offline_access:a.bypass_consent_for_offline_access}})}delete(a){return(0,d.request)(this.fetchConfig,{method:"DELETE",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}`,headers:{},data:{}})}search(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/connected_apps/clients/search",headers:{},data:a})}create(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/connected_apps/clients",headers:{},data:a})}}b.Clients=f},39004:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ProduceJWT=void 0;let d=c(35327),e=c(17600),f=c(21726);function g(a,b){if(!Number.isFinite(b))throw TypeError(`Invalid ${a} input`);return b}class h{_payload;constructor(a={}){if(!(0,e.default)(a))throw TypeError("JWT Claims Set MUST be an object");this._payload=a}setIssuer(a){return this._payload={...this._payload,iss:a},this}setSubject(a){return this._payload={...this._payload,sub:a},this}setAudience(a){return this._payload={...this._payload,aud:a},this}setJti(a){return this._payload={...this._payload,jti:a},this}setNotBefore(a){return"number"==typeof a?this._payload={...this._payload,nbf:g("setNotBefore",a)}:a instanceof Date?this._payload={...this._payload,nbf:g("setNotBefore",(0,d.default)(a))}:this._payload={...this._payload,nbf:(0,d.default)(new Date)+(0,f.default)(a)},this}setExpirationTime(a){return"number"==typeof a?this._payload={...this._payload,exp:g("setExpirationTime",a)}:a instanceof Date?this._payload={...this._payload,exp:g("setExpirationTime",(0,d.default)(a))}:this._payload={...this._payload,exp:(0,d.default)(new Date)+(0,f.default)(a)},this}setIssuedAt(a){return void 0===a?this._payload={...this._payload,iat:(0,d.default)(new Date)}:a instanceof Date?this._payload={...this._payload,iat:g("setIssuedAt",(0,d.default)(a))}:"string"==typeof a?this._payload={...this._payload,iat:g("setIssuedAt",(0,d.default)(new Date)+(0,f.default)(a))}:this._payload={...this._payload,iat:g("setIssuedAt",a)},this}}b.ProduceJWT=h},39019:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TOTPs=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}create(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/totp",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/totp/authenticate",headers:{},data:a})}migrate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/totp/migrate",headers:{},data:a})}}b.TOTPs=e},39225:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createLocalJWKSet=function(a){let b=new i(a),c=async(a,c)=>b.getKey(a,c);return Object.defineProperties(c,{jwks:{value:()=>h(b._jwks),enumerable:!0,configurable:!1,writable:!1}}),c};let d=c(18681),e=c(15860),f=c(17600);function g(a){return(0,f.default)(a)}function h(a){return"function"==typeof structuredClone?structuredClone(a):JSON.parse(JSON.stringify(a))}class i{_jwks;_cached=new WeakMap;constructor(a){if(!function(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(g)}(a))throw new e.JWKSInvalid("JSON Web Key Set malformed");this._jwks=h(a)}async getKey(a,b){let{alg:c,kid:d}={...a,...b?.header},f=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new e.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),g=this._jwks.keys.filter(a=>{let b=f===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&"string"==typeof a.alg&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES256K":b="secp256k1"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv;break;case"Ed25519":b="Ed25519"===a.crv;break;case"EdDSA":b="Ed25519"===a.crv||"Ed448"===a.crv}return b}),{0:h,length:i}=g;if(0===i)throw new e.JWKSNoMatchingKey;if(1!==i){let a=new e.JWKSMultipleMatchingKeys,{_cached:b}=this;throw a[Symbol.asyncIterator]=async function*(){for(let a of g)try{yield await j(b,a,c)}catch{}},a}return j(this._cached,h,c)}}async function j(a,b,c){let f=a.get(b)||a.set(b,{}).get(b);if(void 0===f[c]){let a=await (0,d.importJWK)({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new e.JWKSInvalid("JSON Web Key Set members must be public keys");f[c]=a}return f[c]}},39876:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OIDC=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}createConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/sso/oidc/${encodeURIComponent(a.organization_id)}`,headers:c,data:{display_name:a.display_name,identity_provider:a.identity_provider}})}updateConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/sso/oidc/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}`,headers:c,data:{display_name:a.display_name,client_id:a.client_id,client_secret:a.client_secret,issuer:a.issuer,authorization_url:a.authorization_url,token_url:a.token_url,userinfo_url:a.userinfo_url,jwks_url:a.jwks_url,identity_provider:a.identity_provider,custom_scopes:a.custom_scopes,attribute_mapping:a.attribute_mapping}})}}b.OIDC=f},42079:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0,c(10682);var d=c(60182),e=c(86112);class f{constructor(a){this.fetchConfig=a,this.discovery=new d.Discovery(this.fetchConfig)}loginOrSignup(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/email/login_or_signup",headers:{},data:a})}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/email/authenticate",headers:{},data:a})}}b.Email=f},42293:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.EncryptJWT=void 0;let d=c(25064),e=c(49616),f=c(39004);class g extends f.ProduceJWT{_cek;_iv;_keyManagementParameters;_protectedHeader;_replicateIssuerAsHeader;_replicateSubjectAsHeader;_replicateAudienceAsHeader;setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(a,b){let c=new d.CompactEncrypt(e.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(a,b)}}b.EncryptJWT=g},42832:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.flattenedVerify=o;let d=c(16165),e=c(61756),f=c(15860),g=c(49616),h=c(50215),i=c(17600),j=c(91181),k=c(61801),l=c(96591),m=c(44631),n=c(18681);async function o(a,b,c){let o,p;if(!(0,i.default)(a))throw new f.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new f.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new f.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new f.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new f.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,i.default)(a.header))throw new f.JWSInvalid("JWS Unprotected Header incorrect type");let q={};if(a.protected)try{let b=(0,d.decode)(a.protected);q=JSON.parse(g.decoder.decode(b))}catch{throw new f.JWSInvalid("JWS Protected Header is invalid")}if(!(0,h.default)(q,a.header))throw new f.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...q,...a.header},s=(0,k.default)(f.JWSInvalid,new Map([["b64",!0]]),c?.crit,q,r),t=!0;if(s.has("b64")&&"boolean"!=typeof(t=q.b64))throw new f.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:u}=r;if("string"!=typeof u||!u)throw new f.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let v=c&&(0,l.default)("algorithms",c.algorithms);if(v&&!v.has(u))throw new f.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(t){if("string"!=typeof a.payload)throw new f.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new f.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let w=!1;"function"==typeof b?(b=await b(q,a),w=!0,(0,j.checkKeyTypeWithJwk)(u,b,"verify"),(0,m.isJWK)(b)&&(b=await (0,n.importJWK)(b,u))):(0,j.checkKeyTypeWithJwk)(u,b,"verify");let x=(0,g.concat)(g.encoder.encode(a.protected??""),g.encoder.encode("."),"string"==typeof a.payload?g.encoder.encode(a.payload):a.payload);try{o=(0,d.decode)(a.signature)}catch{throw new f.JWSInvalid("Failed to base64url decode the signature")}if(!await (0,e.default)(u,b,o,x))throw new f.JWSSignatureVerificationFailed;if(t)try{p=(0,d.decode)(a.payload)}catch{throw new f.JWSInvalid("Failed to base64url decode the payload")}else p="string"==typeof a.payload?g.encoder.encode(a.payload):a.payload;let y={payload:p};return(void 0!==a.protected&&(y.protectedHeader=q),void 0!==a.header&&(y.unprotectedHeader=a.header),w)?{...y,key:b}:y}},43916:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a,b,c,f,g,h){let i=(0,e.concat)(a,b,c,(0,e.uint64be)(a.length<<3)),j=(0,d.createHmac)(`sha${f}`,g);return j.update(i),j.digest().slice(0,h>>3)};let d=c(77598),e=c(49616)},44515:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decode=b.encode=void 0;let d=c(16165);b.encode=d.encode,b.decode=d.decode},44631:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.isJWK=e,b.isPrivateJWK=function(a){return"oct"!==a.kty&&"string"==typeof a.d},b.isPublicJWK=function(a){return"oct"!==a.kty&&void 0===a.d},b.isSecretJWK=function(a){return e(a)&&"oct"===a.kty&&"string"==typeof a.k};let d=c(17600);function e(a){return(0,d.default)(a)&&"string"==typeof a.kty}},44787:a=>{a.exports=JSON.parse('{"name":"stytch","version":"12.43.1","description":"A wrapper for the Stytch API","types":"./types/lib/index.d.ts","main":"./dist/index.js","type":"commonjs","exports":{"types":"./types/lib/index.d.ts","require":"./dist/index.js","default":"./dist/index.js"},"files":["dist/**/*","types/**/*"],"repository":{"type":"git","url":"git://github.com/stytchauth/stytch-node.git"},"engines":{"node":">= 18.0.0"},"scripts":{"build":"rm -rf dist types && babel lib --out-dir dist --extensions \'.ts\' && tsc --declaration --outDir types --emitDeclarationOnly","format":"prettier --write .","check-format":"prettier --check .","lint":"eslint lib","test":"jest","test-packages":"./test-packages/test.sh"},"author":"Stytch","bugs":{"url":"git://github.com/stytchauth/stytch-node/issues"},"license":"MIT","devDependencies":{"@babel/cli":"^7.23.0","@babel/core":"^7.23.0","@babel/preset-env":"^7.22.20","@babel/preset-typescript":"^7.23.0","@types/jest":"^29.5.5","@types/node":"^20.14.8","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","eslint":"^7.32.0","jest":"^29.7.0","prettier":"2.4.1","ts-jest":"^29.1.1","typescript":"^5.5.4"},"dependencies":{"jose":"^5.6.3","undici":"^6.19.5"},"eslintConfig":{"extends":"airbnb","env":{"commonjs":true,"node":true,"mocha":true},"rules":{"indent":["error",4],"no-underscore-dangle":0,"strict":0,"prefer-rest-params":0}}}')},46144:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links/email/send",headers:{},data:a})}loginOrCreate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links/email/login_or_create",headers:{},data:a})}invite(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links/email/invite",headers:{},data:a})}revokeInvite(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/magic_links/email/revoke_invite",headers:{},data:a})}}b.Email=e},48508:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.RBAC=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}policy(){return(0,d.request)(this.fetchConfig,{method:"GET",url:"/v1/rbac/policy",headers:{}})}}b.RBAC=e},48601:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.GeneralSign=void 0;let d=c(97343),e=c(15860);class f{parent;protectedHeader;unprotectedHeader;options;key;constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.parent.addSignature(...a)}sign(...a){return this.parent.sign(...a)}done(){return this.parent}}class g{_payload;_signatures=[];constructor(a){this._payload=a}addSignature(a,b){let c=new f(this,a,b);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new e.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this._signatures.length;b++){let c=this._signatures[b],f=new d.FlattenedSign(this._payload);f.setProtectedHeader(c.protectedHeader),f.setUnprotectedHeader(c.unprotectedHeader);let{payload:g,...h}=await f.sign(c.key,c.options);if(0===b)a.payload=g;else if(a.payload!==g)throw new e.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(h)}return a}}b.GeneralSign=g},48733:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SCIM=void 0,c(10682);var d=c(33860);class e{constructor(a){this.fetchConfig=a,this.connection=new d.Connection(this.fetchConfig)}}b.SCIM=e},49616:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decoder=b.encoder=void 0,b.concat=e,b.p2s=function(a,c){return e(b.encoder.encode(a),new Uint8Array([0]),c)},b.uint64be=function(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return f(c,b,0),f(c,a%0x100000000,4),c},b.uint32be=g,b.lengthAndInput=function(a){return e(g(a.length),a)},b.concatKdf=h;let d=c(81841);function e(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;for(let d of a)b.set(d,c),c+=d.length;return b}function f(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function g(a){let b=new Uint8Array(4);return f(b,a),b}async function h(a,b,c){let e=Math.ceil((b>>3)/32),f=new Uint8Array(32*e);for(let b=0;b<e;b++){let e=new Uint8Array(4+a.length+c.length);e.set(g(b+1)),e.set(a,4),e.set(c,4+a.length),f.set(await (0,d.default)("sha256",e),32*b)}return f.slice(0,b>>3)}b.encoder=new TextEncoder,b.decoder=new TextDecoder},50215:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=(...a)=>{let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}},50263:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.bitLength=f;let d=c(15860),e=c(84518);function f(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}b.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},50452:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.fromX509=b.fromSPKI=b.fromPKCS8=b.toPKCS8=b.toSPKI=void 0;let d=c(77598),e=c(4573),f=c(28622),g=c(58515),h=c(53738),i=c(59091),j=(a,b,c)=>{let e;if((0,f.isCryptoKey)(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");e=d.KeyObject.from(c)}else if((0,g.default)(c))e=c;else throw TypeError((0,h.default)(c,...i.types));if(e.type!==a)throw TypeError(`key is not a ${a} key`);return e.export({format:"pem",type:b})};b.toSPKI=a=>j("public","spki",a),b.toPKCS8=a=>j("private","pkcs8",a),b.fromPKCS8=a=>(0,d.createPrivateKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),b.fromSPKI=a=>(0,d.createPublicKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),b.fromX509=a=>(0,d.createPublicKey)({key:a,type:"spki",format:"pem"})},51885:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OAuth=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}attach(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/oauth/attach",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/oauth/authenticate",headers:{},data:a})}}b.OAuth=e},53178:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.test=b.live=b.fraud=void 0,b.test="https://test.stytch.com/",b.live="https://api.stytch.com/",b.fraud="https://telemetry.stytch.com/"},53629:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Organizations=void 0;var d=c(10682),e=c(33349),f=c(86112);class g{constructor(a){this.fetchConfig=a,this.members=new e.Members(this.fetchConfig)}create(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/organizations",headers:{},data:a})}get(a){return(0,f.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}`,headers:{},params:{}})}update(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,f.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}`,headers:c,data:{organization_name:a.organization_name,organization_slug:a.organization_slug,organization_logo_url:a.organization_logo_url,trusted_metadata:a.trusted_metadata,organization_external_id:a.organization_external_id,sso_default_connection_id:a.sso_default_connection_id,sso_jit_provisioning:a.sso_jit_provisioning,sso_jit_provisioning_allowed_connections:a.sso_jit_provisioning_allowed_connections,email_allowed_domains:a.email_allowed_domains,email_jit_provisioning:a.email_jit_provisioning,email_invites:a.email_invites,auth_methods:a.auth_methods,allowed_auth_methods:a.allowed_auth_methods,mfa_policy:a.mfa_policy,rbac_email_implicit_role_assignments:a.rbac_email_implicit_role_assignments,mfa_methods:a.mfa_methods,allowed_mfa_methods:a.allowed_mfa_methods,oauth_tenant_jit_provisioning:a.oauth_tenant_jit_provisioning,allowed_oauth_tenants:a.allowed_oauth_tenants,claimed_email_domains:a.claimed_email_domains,first_party_connected_apps_allowed_type:a.first_party_connected_apps_allowed_type,allowed_first_party_connected_apps:a.allowed_first_party_connected_apps,third_party_connected_apps_allowed_type:a.third_party_connected_apps_allowed_type,allowed_third_party_connected_apps:a.allowed_third_party_connected_apps}})}delete(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,f.request)(this.fetchConfig,{method:"DELETE",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}`,headers:c,data:{}})}search(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/organizations/search",headers:{},data:a})}metrics(a){return(0,f.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/metrics`,headers:{},params:{}})}connectedApps(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,f.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/connected_apps`,headers:c,params:{}})}getConnectedApp(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,f.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/connected_apps/${encodeURIComponent(a.connected_app_id)}`,headers:c,params:{}})}}b.Organizations=g},53738:(a,b)=>{function c(a,b,...d){if((d=d.filter(Boolean)).length>2){let b=d.pop();a+=`one of type ${d.join(", ")}, or ${b}.`}else 2===d.length?a+=`one of type ${d[0]} or ${d[1]}.`:a+=`of type ${d[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor?.name&&(a+=` Received an instance of ${b.constructor.name}`),a}Object.defineProperty(b,"__esModule",{value:!0}),b.withAlg=function(a,b,...d){return c(`Key for the ${a} algorithm must be `,b,...d)},b.default=(a,...b)=>c("Key must be ",a,...b)},54510:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sms=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/sms/send",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/sms/authenticate",headers:{},data:a})}}b.Sms=e},55167:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decodeJwt=function(a){let b,c;if("string"!=typeof a)throw new g.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:h,length:i}=a.split(".");if(5===i)throw new g.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==i)throw new g.JWTInvalid("Invalid JWT");if(!h)throw new g.JWTInvalid("JWTs must contain a payload");try{b=(0,d.decode)(h)}catch{throw new g.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(e.decoder.decode(b))}catch{throw new g.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,f.default)(c))throw new g.JWTInvalid("Invalid JWT Claims Set");return c};let d=c(44515),e=c(49616),f=c(17600),g=c(15860)},55245:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Impersonation=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/impersonation/authenticate",headers:{},data:a})}}b.Impersonation=e},55394:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.generateKeyPair=e;let d=c(21806);async function e(a,b){return(0,d.generateKeyPair)(a,b)}},56142:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.compactVerify=g;let d=c(42832),e=c(15860),f=c(49616);async function g(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:g,1:h,2:i,length:j}=a.split(".");if(3!==j)throw new e.JWSInvalid("Invalid Compact JWS");let k=await (0,d.flattenedVerify)({payload:h,protected:g,signature:i},b,c),l={payload:k.payload,protectedHeader:k.protectedHeader};return"function"==typeof b?{...l,key:k.key}:l}},56604:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sessions=void 0;var d=c(10682),e=c(86112),f=c(93383),g=c(96361);class h{constructor(a,b,c){this.fetchConfig=a,this.jwksClient=b.jwks,this.jwtOptions={audience:b.projectID,issuer:b.issuers,typ:"JWT"},this.policyCache=c}get(a){return(0,e.request)(this.fetchConfig,{method:"GET",url:"/v1/b2b/sessions",headers:{},params:{...a}})}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/authenticate",headers:{},data:a})}revoke(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/revoke",headers:c,data:a})}exchange(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/exchange",headers:{},data:a})}exchangeAccessToken(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/exchange_access_token",headers:{},data:a})}attest(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/attest",headers:{},data:a})}migrate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/sessions/migrate",headers:{},data:a})}getJWKS(a){return(0,e.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/sessions/jwks/${encodeURIComponent(a.project_id)}`,headers:{},params:{}})}async authenticateJwt(a){try{return{member_session:await this.authenticateJwtLocal(a),session_jwt:a.session_jwt}}catch(b){return this.authenticate({session_jwt:a.session_jwt,authorization_check:a.authorization_check})}}async authenticateJwtLocal(a){let b=await (0,f.authenticateSessionJwtLocal)(this.jwksClient,this.jwtOptions,a.session_jwt,{clock_tolerance_seconds:a.clock_tolerance_seconds,max_token_age_seconds:a.max_token_age_seconds,current_date:a.current_date}),{"https://stytch.com/organization":c,...d}=b.custom_claims;if(a.authorization_check){let d=await this.policyCache.getPolicy();(0,g.performAuthorizationCheck)({policy:d,subjectRoles:b.roles,subjectOrgID:c.organization_id,authorizationCheck:a.authorization_check})}return{member_session_id:b.session_id,member_id:b.sub,organization_id:c.organization_id,authentication_factors:b.authentication_factors,started_at:b.started_at,last_accessed_at:b.last_accessed_at,expires_at:b.expires_at,custom_claims:d,roles:b.roles,organization_slug:c.slug}}}b.Sessions=h},56695:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.IntermediateSessions=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}exchange(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/discovery/intermediate_sessions/exchange",headers:{},data:a})}}b.IntermediateSessions=e},56994:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.decodeProtectedHeader=function(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(e.decoder.decode((0,d.decode)(b)));if(!(0,f.default)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}};let d=c(44515),e=c(49616),f=c(17600)},57166:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(2601),e=c(86112);class f{constructor(a){this.fetchConfig=a,this.email=new d.Email(this.fetchConfig)}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/discovery/authenticate",headers:{},data:a})}}b.Discovery=f},57398:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.cryptoRuntime=b.base64url=b.generateSecret=b.generateKeyPair=b.errors=b.decodeJwt=b.decodeProtectedHeader=b.importJWK=b.importX509=b.importPKCS8=b.importSPKI=b.exportJWK=b.exportSPKI=b.exportPKCS8=b.UnsecuredJWT=b.experimental_jwksCache=b.jwksCache=b.createRemoteJWKSet=b.createLocalJWKSet=b.EmbeddedJWK=b.calculateJwkThumbprintUri=b.calculateJwkThumbprint=b.EncryptJWT=b.SignJWT=b.GeneralSign=b.FlattenedSign=b.CompactSign=b.FlattenedEncrypt=b.CompactEncrypt=b.jwtDecrypt=b.jwtVerify=b.generalVerify=b.flattenedVerify=b.compactVerify=b.GeneralEncrypt=b.generalDecrypt=b.flattenedDecrypt=b.compactDecrypt=void 0;var d=c(5436);Object.defineProperty(b,"compactDecrypt",{enumerable:!0,get:function(){return d.compactDecrypt}});var e=c(12754);Object.defineProperty(b,"flattenedDecrypt",{enumerable:!0,get:function(){return e.flattenedDecrypt}});var f=c(26777);Object.defineProperty(b,"generalDecrypt",{enumerable:!0,get:function(){return f.generalDecrypt}});var g=c(81857);Object.defineProperty(b,"GeneralEncrypt",{enumerable:!0,get:function(){return g.GeneralEncrypt}});var h=c(56142);Object.defineProperty(b,"compactVerify",{enumerable:!0,get:function(){return h.compactVerify}});var i=c(42832);Object.defineProperty(b,"flattenedVerify",{enumerable:!0,get:function(){return i.flattenedVerify}});var j=c(58673);Object.defineProperty(b,"generalVerify",{enumerable:!0,get:function(){return j.generalVerify}});var k=c(64031);Object.defineProperty(b,"jwtVerify",{enumerable:!0,get:function(){return k.jwtVerify}});var l=c(82253);Object.defineProperty(b,"jwtDecrypt",{enumerable:!0,get:function(){return l.jwtDecrypt}});var m=c(25064);Object.defineProperty(b,"CompactEncrypt",{enumerable:!0,get:function(){return m.CompactEncrypt}});var n=c(11674);Object.defineProperty(b,"FlattenedEncrypt",{enumerable:!0,get:function(){return n.FlattenedEncrypt}});var o=c(98946);Object.defineProperty(b,"CompactSign",{enumerable:!0,get:function(){return o.CompactSign}});var p=c(97343);Object.defineProperty(b,"FlattenedSign",{enumerable:!0,get:function(){return p.FlattenedSign}});var q=c(48601);Object.defineProperty(b,"GeneralSign",{enumerable:!0,get:function(){return q.GeneralSign}});var r=c(36759);Object.defineProperty(b,"SignJWT",{enumerable:!0,get:function(){return r.SignJWT}});var s=c(42293);Object.defineProperty(b,"EncryptJWT",{enumerable:!0,get:function(){return s.EncryptJWT}});var t=c(12806);Object.defineProperty(b,"calculateJwkThumbprint",{enumerable:!0,get:function(){return t.calculateJwkThumbprint}}),Object.defineProperty(b,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return t.calculateJwkThumbprintUri}});var u=c(60959);Object.defineProperty(b,"EmbeddedJWK",{enumerable:!0,get:function(){return u.EmbeddedJWK}});var v=c(39225);Object.defineProperty(b,"createLocalJWKSet",{enumerable:!0,get:function(){return v.createLocalJWKSet}});var w=c(60666);Object.defineProperty(b,"createRemoteJWKSet",{enumerable:!0,get:function(){return w.createRemoteJWKSet}}),Object.defineProperty(b,"jwksCache",{enumerable:!0,get:function(){return w.jwksCache}}),Object.defineProperty(b,"experimental_jwksCache",{enumerable:!0,get:function(){return w.experimental_jwksCache}});var x=c(27566);Object.defineProperty(b,"UnsecuredJWT",{enumerable:!0,get:function(){return x.UnsecuredJWT}});var y=c(82402);Object.defineProperty(b,"exportPKCS8",{enumerable:!0,get:function(){return y.exportPKCS8}}),Object.defineProperty(b,"exportSPKI",{enumerable:!0,get:function(){return y.exportSPKI}}),Object.defineProperty(b,"exportJWK",{enumerable:!0,get:function(){return y.exportJWK}});var z=c(18681);Object.defineProperty(b,"importSPKI",{enumerable:!0,get:function(){return z.importSPKI}}),Object.defineProperty(b,"importPKCS8",{enumerable:!0,get:function(){return z.importPKCS8}}),Object.defineProperty(b,"importX509",{enumerable:!0,get:function(){return z.importX509}}),Object.defineProperty(b,"importJWK",{enumerable:!0,get:function(){return z.importJWK}});var A=c(56994);Object.defineProperty(b,"decodeProtectedHeader",{enumerable:!0,get:function(){return A.decodeProtectedHeader}});var B=c(55167);Object.defineProperty(b,"decodeJwt",{enumerable:!0,get:function(){return B.decodeJwt}}),b.errors=c(15860);var C=c(55394);Object.defineProperty(b,"generateKeyPair",{enumerable:!0,get:function(){return C.generateKeyPair}});var D=c(12470);Object.defineProperty(b,"generateSecret",{enumerable:!0,get:function(){return D.generateSecret}}),b.base64url=c(44515);var E=c(60631);Object.defineProperty(b,"cryptoRuntime",{enumerable:!0,get:function(){return E.default}})},58071:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}resetStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/email/reset/start",headers:{},data:a})}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/email/reset",headers:{},data:a})}}b.Email=e},58154:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.wrap=g,b.unwrap=h;let d=c(72396),e=c(10496),f=c(16165);async function g(a,b,c,e){let g=a.slice(0,7),h=await (0,d.default)(g,c,b,e,new Uint8Array(0));return{encryptedKey:h.ciphertext,iv:(0,f.encode)(h.iv),tag:(0,f.encode)(h.tag)}}async function h(a,b,c,d,f){let g=a.slice(0,7);return(0,e.default)(g,b,c,d,f,new Uint8Array(0))}},58515:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(57975);b.default=a=>d.types.isKeyObject(a)},58621:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sessions=void 0,c(10682);var d=c(86112),e=c(93383),f=c(62872);class g{constructor(a,b,c){this.fetchConfig=a,this.jwksClient=b.jwks,this.jwtOptions={audience:b.projectID,issuer:b.issuers,typ:"JWT"},this.policyCache=c}get(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:"/v1/sessions",headers:{},params:{...a}})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/sessions/authenticate",headers:{},data:a})}revoke(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/sessions/revoke",headers:{},data:a})}migrate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/sessions/migrate",headers:{},data:a})}exchangeAccessToken(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/sessions/exchange_access_token",headers:{},data:a})}getJWKS(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/sessions/jwks/${encodeURIComponent(a.project_id)}`,headers:{},params:{}})}attest(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/sessions/attest",headers:{},data:a})}async authenticateJwt(a){try{return{session:await this.authenticateJwtLocal(a),session_jwt:a.session_jwt}}catch(b){return this.authenticate({session_jwt:a.session_jwt,authorization_check:a.authorization_check})}}async authenticateJwtLocal(a){let b=await (0,e.authenticateSessionJwtLocal)(this.jwksClient,this.jwtOptions,a.session_jwt,{clock_tolerance_seconds:a.clock_tolerance_seconds,max_token_age_seconds:a.max_token_age_seconds,current_date:a.current_date});if(a.authorization_check){let c=await this.policyCache.getPolicy();await (0,f.performAuthorizationCheck)({policy:c,subjectRoles:b.roles,authorizationCheck:a.authorization_check})}return{session_id:b.session_id,attributes:b.attributes,authentication_factors:b.authentication_factors,user_id:b.sub,started_at:b.started_at,last_accessed_at:b.last_accessed_at,expires_at:b.expires_at,custom_claims:b.custom_claims,roles:b.roles}}}b.Sessions=g},58673:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.generalVerify=g;let d=c(42832),e=c(15860),f=c(17600);async function g(a,b,c){if(!(0,f.default)(a))throw new e.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(f.default))throw new e.JWSInvalid("JWS Signatures missing or incorrect type");for(let e of a.signatures)try{return await (0,d.flattenedVerify)({header:e.header,payload:a.payload,protected:e.protected,signature:e.signature},b,c)}catch{}throw new e.JWSSignatureVerificationFailed}},59091:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.types=void 0;let d=c(28622),e=c(58515);b.default=a=>(0,e.default)(a)||(0,d.isCryptoKey)(a);let f=["KeyObject"];b.types=f,(globalThis.CryptoKey||d.default?.CryptoKey)&&f.push("CryptoKey")},60182:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/email/discovery/send",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/otps/email/discovery/authenticate",headers:{},data:a})}}b.Discovery=e},60631:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=c(68249).default},60647:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0;var d=c(10682),e=c(8414),f=c(86112);class g{constructor(a){this.fetchConfig=a,this.discovery=new e.Discovery(this.fetchConfig)}loginOrSignup(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/magic_links/email/login_or_signup",headers:{},data:a})}invite(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/magic_links/email/invite",headers:c,data:a})}}b.Email=g},60666:(a,b,c)=>{let d;Object.defineProperty(b,"__esModule",{value:!0}),b.experimental_jwksCache=b.jwksCache=void 0,b.createRemoteJWKSet=function(a,b){let c=new i(a,b),d=async(a,b)=>c.getKey(a,b);return Object.defineProperties(d,{coolingDown:{get:()=>c.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>c.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>c.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!c._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>c._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),d};let e=c(66945),f=c(15860),g=c(39225),h=c(17600);("u"<typeof navigator||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(d="jose/v5.10.0"),b.jwksCache=Symbol();class i{_url;_timeoutDuration;_cooldownDuration;_cacheMaxAge;_jwksTimestamp;_pendingFetch;_options;_local;_cache;constructor(a,c){if(!(a instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(a.href),this._options={agent:c?.agent,headers:c?.headers},this._timeoutDuration="number"==typeof c?.timeoutDuration?c?.timeoutDuration:5e3,this._cooldownDuration="number"==typeof c?.cooldownDuration?c?.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof c?.cacheMaxAge?c?.cacheMaxAge:6e5,c?.[b.jwksCache]!==void 0&&(this._cache=c?.[b.jwksCache],function(a,b){return!("object"!=typeof a||null===a||!("uat"in a)||"number"!=typeof a.uat||Date.now()-a.uat>=b)&&"jwks"in a&&!!(0,h.default)(a.jwks)&&!!Array.isArray(a.jwks.keys)&&!!Array.prototype.every.call(a.jwks.keys,h.default)}(c?.[b.jwksCache],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=(0,g.createLocalJWKSet)(this._cache.jwks)))}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(a,b){this._local&&this.fresh()||await this.reload();try{return await this._local(a,b)}catch(c){if(c instanceof f.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),this._local(a,b);throw c}}async reload(){this._pendingFetch&&("u">typeof WebSocketPair||"u">typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"u">typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0);let a=new Headers(this._options.headers);d&&!a.has("User-Agent")&&(a.set("User-Agent",d),this._options.headers=Object.fromEntries(a.entries())),this._pendingFetch||=(0,e.default)(this._url,this._timeoutDuration,this._options).then(a=>{this._local=(0,g.createLocalJWKSet)(a),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=a),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a}),await this._pendingFetch}}b.experimental_jwksCache=b.jwksCache},60817:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BaseClient=void 0;var d=g(c(53178)),e=c(44787),f=c(68677);function g(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(g=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}class h{constructor(a){if("object"!=typeof a)throw Error("Unexpected config type. Refer to https://github.com/stytchauth/stytch-node for how to use the Node client library.");if(!a.project_id)throw Error('Missing "project_id" in config');if(!a.secret)throw Error('Missing "secret" in config');if(a.env&&a.custom_base_url&&console.warn("[Stytch] Warning: Both 'env' and 'base_url' were provided in the client config. 'env' will be ignored in favor of 'base_url'."),a.custom_base_url&&!a.custom_base_url.startsWith("https://"))throw Error("custom_base_url must use HTTPS scheme");a.env||(a.project_id.startsWith("project-live-")?a.env=d.live:a.env=d.test),a.fraud_env||(a.fraud_env=d.fraud),a.env!=d.test&&a.env!=d.live&&console.warn(`[Stytch] Warning: Using a custom 'env' value ("${a.env}") instead of 'envs.test' or 'envs.live". If you're attempting to use a custom baseURL consider the base_url parameter.`);const b={"Content-Type":"application/json","User-Agent":`Stytch Node v${e.version}`,Authorization:"Basic "+(0,f.base64Encode)(a.project_id+":"+a.secret)},c=a.custom_base_url||a.env;this.fetchConfig={baseURL:c,fraudBaseURL:a.fraud_env,headers:b,timeout:a.timeout||6e5,dispatcher:a.dispatcher},this.baseURL=c,this.baseURL.endsWith("/")||(this.baseURL+="/")}}b.BaseClient=h},60959:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.EmbeddedJWK=g;let d=c(18681),e=c(17600),f=c(15860);async function g(a,b){let c={...a,...b?.header};if(!(0,e.default)(c.jwk))throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let g=await (0,d.importJWK)({...c.jwk,ext:!0},c.alg);if(g instanceof Uint8Array||"public"!==g.type)throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return g}},61756:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598),e=c(57975),f=c(92956),g=c(84601),h=c(91136),i=c(91289),j=(0,e.promisify)(d.verify);b.default=async(a,b,c,e)=>{let k=(0,i.default)(a,b,"verify");if(a.startsWith("HS")){let b=await (0,h.default)(a,k,e);try{return d.timingSafeEqual(c,b)}catch{return!1}}let l=(0,f.default)(a),m=(0,g.default)(a,k);try{return await j(l,e,m,c)}catch{return!1}}},61801:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(15860);b.default=function(a,b,c,e,f){let g;if(void 0!==f.crit&&e?.crit===void 0)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!e||void 0===e.crit)return new Set;if(!Array.isArray(e.crit)||0===e.crit.length||e.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let h of(g=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,e.crit)){if(!g.has(h))throw new d.JOSENotSupported(`Extension Header Parameter "${h}" is not recognized`);if(void 0===f[h])throw new a(`Extension Header Parameter "${h}" is missing`);if(g.get(h)&&void 0===e[h])throw new a(`Extension Header Parameter "${h}" MUST be integrity protected`)}return new Set(e.crit)}},61957:(a,b,c)=>{let d;Object.defineProperty(b,"__esModule",{value:!0});let e=c(77598);b.default=a=>(d||=new Set((0,e.getCiphers)())).has(a)},62043:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sessions=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/session/reset",headers:{},data:a})}}b.Sessions=e},62872:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PolicyCache=void 0,b.performAuthorizationCheck=function({policy:a,subjectRoles:b,authorizationCheck:c}){(0,d.performBaseRoleAuthorizationCheck)({policy:a,subjectRoles:b,authorizationCheck:c,callerType:"User"})},b.performScopeAuthorizationCheck=function({policy:a,tokenScopes:b,authorizationCheck:c}){return(0,d.performBaseScopeAuthorizationCheck)({policy:a,tokenScopes:b,authorizationCheck:c,callerType:"User"})};var d=c(74618);class e extends d.BasePolicyCache{}b.PolicyCache=e},63001:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(63400),e=c(22725),f=c(26279),g=c(27931),h=c(16165),i=c(70466),j=c(11883),k=c(15860),l=c(82402),m=c(91181),n=c(58154);b.default=async function(a,b,c,o,p={}){let q,r,s;switch((0,m.default)(a,c,"encrypt"),c=await i.default.normalizePublicKey?.(c,a)||c,a){case"dir":s=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!e.ecdhAllowed(c))throw new k.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:f,apv:g}=p,{epk:i}=p;i||=(await e.generateEpk(c)).privateKey;let{x:m,y:n,crv:t,kty:u}=await (0,l.exportJWK)(i),v=await e.deriveKey(c,i,"ECDH-ES"===a?b:a,"ECDH-ES"===a?(0,j.bitLength)(b):parseInt(a.slice(-5,-2),10),f,g);if(r={epk:{x:m,crv:t,kty:u}},"EC"===u&&(r.epk.y=n),f&&(r.apu=(0,h.encode)(f)),g&&(r.apv=(0,h.encode)(g)),"ECDH-ES"===a){s=v;break}s=o||(0,j.default)(b);let w=a.slice(-6);q=await (0,d.wrap)(w,v,s);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s=o||(0,j.default)(b),q=await (0,g.encrypt)(a,c,s);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{s=o||(0,j.default)(b);let{p2c:d,p2s:e}=p;({encryptedKey:q,...r}=await (0,f.encrypt)(a,c,s,d,e));break}case"A128KW":case"A192KW":case"A256KW":s=o||(0,j.default)(b),q=await (0,d.wrap)(a,c,s);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{s=o||(0,j.default)(b);let{iv:d}=p;({encryptedKey:q,...r}=await (0,n.wrap)(a,c,s,d));break}default:throw new k.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:s,encryptedKey:q,parameters:r}}},63400:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.unwrap=b.wrap=void 0;let d=c(4573),e=c(77598),f=c(15860),g=c(49616),h=c(28622),i=c(92749),j=c(58515),k=c(53738),l=c(61957),m=c(59091);function n(a,b){if(a.symmetricKeySize<<3!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function o(a,b,c){if((0,j.default)(a))return a;if(a instanceof Uint8Array)return(0,e.createSecretKey)(a);if((0,h.isCryptoKey)(a))return(0,i.checkEncCryptoKey)(a,b,c),e.KeyObject.from(a);throw TypeError((0,k.default)(a,...m.types,"Uint8Array"))}b.wrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"wrapKey");n(j,a);let k=(0,e.createCipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())},b.unwrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"unwrapKey");n(j,a);let k=(0,e.createDecipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())}},63896:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OAuthProviders=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}google(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oauth_providers/google`,headers:{},params:{include_refresh_token:a.include_refresh_token}})}microsoft(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oauth_providers/microsoft`,headers:{},params:{include_refresh_token:a.include_refresh_token}})}slack(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oauth_providers/slack`,headers:{},params:{}})}hubspot(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oauth_providers/hubspot`,headers:{},params:{include_refresh_token:a.include_refresh_token}})}github(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/organizations/${encodeURIComponent(a.organization_id)}/members/${encodeURIComponent(a.member_id)}/oauth_providers/github`,headers:{},params:{include_refresh_token:a.include_refresh_token}})}}b.OAuthProviders=e},64031:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.jwtVerify=g;let d=c(56142),e=c(79648),f=c(15860);async function g(a,b,c){let g=await (0,d.compactVerify)(a,b,c);if(g.protectedHeader.crit?.includes("b64")&&!1===g.protectedHeader.b64)throw new f.JWTInvalid("JWTs MUST NOT use unencoded payload");let h={payload:(0,e.default)(g.protectedHeader,g.payload,c),protectedHeader:g.protectedHeader};return"function"==typeof b?{...h,key:g.key}:h}},64271:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(56695),e=c(21204);class f{constructor(a){this.fetchConfig=a,this.intermediateSessions=new d.IntermediateSessions(this.fetchConfig),this.organizations=new e.Organizations(this.fetchConfig)}}b.Discovery=f},65200:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MagicLinks=void 0,c(10682);var d=c(13457),e=c(60647),f=c(86112);class g{constructor(a){this.fetchConfig=a,this.email=new e.Email(this.fetchConfig),this.discovery=new d.Discovery(this.fetchConfig)}authenticate(a){return(0,f.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/magic_links/authenticate",headers:{},data:a})}}b.MagicLinks=g},65465:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.StytchError=b.RequestError=b.ClientError=void 0;class c extends Error{constructor(a){super(JSON.stringify(a)),"error"in a?(this.status_code=a.status_code,this.request_id=a.request_id,this.error_type=a.error,this.error_message=a.error_description,this.error_url=a.error_uri):(this.status_code=a.status_code,this.request_id=a.request_id,this.error_type=a.error_type,this.error_message=a.error_message,this.error_url=a.error_url,this.error_details=a.error_details)}}b.StytchError=c;class d extends Error{constructor(a,b){super(a),this.request=b}}b.RequestError=d;class e extends Error{constructor(a,b,c){let d=`${a}: ${b}`;c&&(d+=`: ${c}`),super(d),this.code=a,this.cause=c}}b.ClientError=e},66575:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Clients=void 0,c(10682);var d=c(86112),e=c(84925);class f{constructor(a){this.fetchConfig=a,this.secrets=new e.Secrets(this.fetchConfig)}get(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}`,headers:{},params:{}})}search(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/m2m/clients/search",headers:{},data:a})}update(a){return(0,d.request)(this.fetchConfig,{method:"PUT",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}`,headers:{},data:{client_name:a.client_name,client_description:a.client_description,status:a.status,scopes:a.scopes,trusted_metadata:a.trusted_metadata}})}delete(a){return(0,d.request)(this.fetchConfig,{method:"DELETE",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}`,headers:{},data:{}})}create(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/m2m/clients",headers:{},data:a})}}b.Clients=f},66945:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(37067),e=c(44708),f=c(78474),g=c(15860),h=c(49616);b.default=async(a,b,c)=>{let i;switch(a.protocol){case"https:":i=e.get;break;case"http:":i=d.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:j,headers:k}=c,l=i(a.href,{agent:j,timeout:b,headers:k}),[m]=await Promise.race([(0,f.once)(l,"response"),(0,f.once)(l,"timeout")]);if(!m)throw l.destroy(),new g.JWKSTimeout;if(200!==m.statusCode)throw new g.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let n=[];for await(let a of m)n.push(a);try{return JSON.parse(h.decoder.decode((0,h.concat)(...n)))}catch{throw new g.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}},68164:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ExistingPassword=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}reset(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/passwords/existing_password/reset",headers:{},data:a})}}b.ExistingPassword=e},68249:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default="node:crypto"},68421:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.RBAC=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}policy(){return(0,d.request)(this.fetchConfig,{method:"GET",url:"/v1/b2b/rbac/policy",headers:{}})}}b.RBAC=e},68633:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/email/send",headers:{},data:a})}loginOrCreate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/email/login_or_create",headers:{},data:a})}}b.Email=e},68677:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.base64Encode=function(a){let b="";for(let b=0;b<a.length;b++)if(a.charCodeAt(b)>128)throw Error("Base64 encoded unicode is not supported. Cannot encode "+a);let d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;for(;k<a.length;)d=a.charCodeAt(k++),e=a.charCodeAt(k++),f=a.charCodeAt(k++),g=d>>2,h=(3&d)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,isNaN(e)?i=j=64:isNaN(f)&&(j=64),b=b+c.charAt(g)+c.charAt(h)+c.charAt(i)+c.charAt(j);return b};let c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},69354:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.External=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}createConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:`/v1/b2b/sso/external/${encodeURIComponent(a.organization_id)}`,headers:c,data:{external_organization_id:a.external_organization_id,external_connection_id:a.external_connection_id,display_name:a.display_name,connection_implicit_role_assignments:a.connection_implicit_role_assignments,group_implicit_role_assignments:a.group_implicit_role_assignments}})}updateConnection(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"PUT",url:`/v1/b2b/sso/external/${encodeURIComponent(a.organization_id)}/connections/${encodeURIComponent(a.connection_id)}`,headers:c,data:{display_name:a.display_name,external_connection_implicit_role_assignments:a.external_connection_implicit_role_assignments,external_group_implicit_role_assignments:a.external_group_implicit_role_assignments}})}}b.External=f},70409:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a){switch(a){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}};let d=c(15860)},70466:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default={}},70622:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.WebAuthn=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}registerStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/webauthn/register/start",headers:{},data:a})}register(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/webauthn/register",headers:{},data:a})}authenticateStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/webauthn/authenticate/start",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/webauthn/authenticate",headers:{},data:a})}update(a){return(0,d.request)(this.fetchConfig,{method:"PUT",url:`/v1/webauthn/${encodeURIComponent(a.webauthn_registration_id)}`,headers:{},data:{name:a.name}})}listCredentials(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/webauthn/credentials/${encodeURIComponent(a.user_id)}/${encodeURIComponent(a.domain)}`,headers:{},params:{}})}}b.WebAuthn=e},71979:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.RecoveryCodes=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}recover(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/recovery_codes/recover",headers:{},data:a})}get(a){return(0,d.request)(this.fetchConfig,{method:"GET",url:`/v1/b2b/recovery_codes/${encodeURIComponent(a.organization_id)}/${encodeURIComponent(a.member_id)}`,headers:{},params:{}})}rotate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/recovery_codes/rotate",headers:{},data:a})}}b.RecoveryCodes=e},72396:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598),e=c(33493),f=c(81078),g=c(49616),h=c(43916),i=c(28622),j=c(92749),k=c(58515),l=c(53738),m=c(50263),n=c(15860),o=c(61957),p=c(59091);b.default=(a,b,c,q,r)=>{let s;if((0,i.isCryptoKey)(c))(0,j.checkEncCryptoKey)(c,a,"encrypt"),s=d.KeyObject.from(c);else if(c instanceof Uint8Array||(0,k.default)(c))s=c;else throw TypeError((0,l.default)(c,...p.types,"Uint8Array"));switch((0,f.default)(a,s),q?(0,e.default)(a,q):q=(0,m.default)(a),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f){let i=parseInt(a.slice(1,4),10);(0,k.default)(c)&&(c=c.export());let j=c.subarray(i>>3),l=c.subarray(0,i>>3),m=`aes-${i}-cbc`;if(!(0,o.default)(m))throw new n.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let p=(0,d.createCipheriv)(m,j,e),q=(0,g.concat)(p.update(b),p.final()),r=parseInt(a.slice(-3),10),s=(0,h.default)(f,e,q,r,l,i);return{ciphertext:q,tag:s,iv:e}}(a,b,s,q,r);case"A128GCM":case"A192GCM":case"A256GCM":var t=s,u=q;let v=parseInt(a.slice(1,4),10),w=`aes-${v}-gcm`;if(!(0,o.default)(w))throw new n.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let x=(0,d.createCipheriv)(w,t,u,{authTagLength:16});r.byteLength&&x.setAAD(r,{plaintextLength:b.length});let y=x.update(b);return x.final(),{ciphertext:y,tag:x.getAuthTag(),iv:u};default:throw new n.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},74618:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BasePolicyCache=void 0,b.performBaseRoleAuthorizationCheck=function({policy:a,subjectRoles:b,authorizationCheck:c,callerType:e}){if(!a.roles.filter(a=>b.includes(a.role_id)).flatMap(a=>a.permissions).some(a=>{let b=a.actions.includes(c.action)||a.actions.includes("*"),d=c.resource_id===a.resource_id;return b&&d}))throw new d.ClientError("invalid_permissions",`${e} does not have permission to perform the requested action`)},b.performBaseScopeAuthorizationCheck=function({policy:a,tokenScopes:b,authorizationCheck:c,callerType:e}){if(!a.scopes.filter(a=>b.includes(a.scope)).flatMap(a=>a.permissions).some(a=>{let b=a.actions.includes(c.action)||a.actions.includes("*"),d=c.resource_id===a.resource_id;return b&&d}))throw new d.ClientError("invalid_permissions",`${e} does not have permission to perform the requested action`)};var d=c(65465);class e{constructor(a){this.rbac=a}fresh(){return!!this._timestamp&&Date.now()<this._timestamp+3e5}async reload(){let a=await this.rbac.policy();return this._policy=a.policy,this._timestamp=Date.now(),this._policy}async getPolicy(){return this._policy&&this.fresh()?this._policy:this.reload()}}b.BasePolicyCache=e},75871:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Client=void 0;var d=y(c(57398)),e=c(60817),f=c(79652),g=c(29088),h=c(14061),i=c(87520),j=c(11669),k=c(17070),l=c(93383),m=c(29316),n=c(24655),o=c(51885),p=c(78910),q=c(26976),r=c(62872),s=c(37147),t=c(48508),u=c(58621),v=c(79288),w=c(18166),x=c(70622);function y(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(y=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}class z extends e.BaseClient{constructor(a){super(a),this.jwtConfig={projectID:a.project_id,jwks:d.createRemoteJWKSet(new URL(`/v1/sessions/jwks/${a.project_id}`,this.fetchConfig.baseURL)),issuers:[`stytch.com/${a.project_id}`,(0,l.trimTrailingSlash)(this.fetchConfig.baseURL)]};const b=new r.PolicyCache(new t.RBAC(this.fetchConfig));this.connectedApp=new f.ConnectedApp(this.fetchConfig),this.cryptoWallets=new g.CryptoWallets(this.fetchConfig),this.debug=new h.Debug(this.fetchConfig),this.fraud=new i.Fraud(this.fetchConfig),this.idp=new j.IDP(this.fetchConfig,this.jwtConfig,b),this.impersonation=new k.Impersonation(this.fetchConfig),this.m2m=new m.M2M(this.fetchConfig,this.jwtConfig),this.magicLinks=new n.MagicLinks(this.fetchConfig),this.oauth=new o.OAuth(this.fetchConfig),this.otps=new p.OTPs(this.fetchConfig),this.passwords=new q.Passwords(this.fetchConfig),this.project=new s.Project(this.fetchConfig),this.rbac=new t.RBAC(this.fetchConfig),this.sessions=new u.Sessions(this.fetchConfig,this.jwtConfig,b),this.totps=new v.TOTPs(this.fetchConfig),this.users=new w.Users(this.fetchConfig),this.webauthn=new x.WebAuthn(this.fetchConfig)}}b.Client=z},76119:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Passwords=void 0,c(10682);var d=c(57166),e=c(91016),f=c(15267),g=c(86112),h=c(22200);class i{constructor(a){this.fetchConfig=a,this.email=new e.Email(this.fetchConfig),this.sessions=new h.Sessions(this.fetchConfig),this.existingPassword=new f.ExistingPassword(this.fetchConfig),this.discovery=new d.Discovery(this.fetchConfig)}strengthCheck(a){return(0,g.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/strength_check",headers:{},data:a})}migrate(a){return(0,g.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/migrate",headers:{},data:a})}authenticate(a){return(0,g.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/authenticate",headers:{},data:a})}}b.Passwords=i},78910:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OTPs=void 0,c(10682);var d=c(68633),e=c(86112),f=c(88504),g=c(29931);class h{constructor(a){this.fetchConfig=a,this.sms=new f.Sms(this.fetchConfig),this.whatsapp=new g.Whatsapp(this.fetchConfig),this.email=new d.Email(this.fetchConfig)}authenticate(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/authenticate",headers:{},data:a})}}b.OTPs=h},79288:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TOTPs=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}create(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/totps",headers:{},data:a})}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/totps/authenticate",headers:{},data:a})}recoveryCodes(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/totps/recovery_codes",headers:{},data:a})}recover(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/totps/recover",headers:{},data:a})}}b.TOTPs=e},79648:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(15860),e=c(49616),f=c(35327),g=c(21726),h=c(17600),i=a=>a.toLowerCase().replace(/^application\//,"");b.default=(a,b,c={})=>{var j,k;let l,m;try{l=JSON.parse(e.decoder.decode(b))}catch{}if(!(0,h.default)(l))throw new d.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:n}=c;if(n&&("string"!=typeof a.typ||i(a.typ)!==i(n)))throw new d.JWTClaimValidationFailed('unexpected "typ" JWT header value',l,"typ","check_failed");let{requiredClaims:o=[],issuer:p,subject:q,audience:r,maxTokenAge:s}=c,t=[...o];for(let a of(void 0!==s&&t.push("iat"),void 0!==r&&t.push("aud"),void 0!==q&&t.push("sub"),void 0!==p&&t.push("iss"),new Set(t.reverse())))if(!(a in l))throw new d.JWTClaimValidationFailed(`missing required "${a}" claim`,l,a,"missing");if(p&&!(Array.isArray(p)?p:[p]).includes(l.iss))throw new d.JWTClaimValidationFailed('unexpected "iss" claim value',l,"iss","check_failed");if(q&&l.sub!==q)throw new d.JWTClaimValidationFailed('unexpected "sub" claim value',l,"sub","check_failed");if(r&&(j=l.aud,k="string"==typeof r?[r]:r,"string"==typeof j?!k.includes(j):!(Array.isArray(j)&&k.some(Set.prototype.has.bind(new Set(j))))))throw new d.JWTClaimValidationFailed('unexpected "aud" claim value',l,"aud","check_failed");switch(typeof c.clockTolerance){case"string":m=(0,g.default)(c.clockTolerance);break;case"number":m=c.clockTolerance;break;case"undefined":m=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:u}=c,v=(0,f.default)(u||new Date);if((void 0!==l.iat||s)&&"number"!=typeof l.iat)throw new d.JWTClaimValidationFailed('"iat" claim must be a number',l,"iat","invalid");if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new d.JWTClaimValidationFailed('"nbf" claim must be a number',l,"nbf","invalid");if(l.nbf>v+m)throw new d.JWTClaimValidationFailed('"nbf" claim timestamp check failed',l,"nbf","check_failed")}if(void 0!==l.exp){if("number"!=typeof l.exp)throw new d.JWTClaimValidationFailed('"exp" claim must be a number',l,"exp","invalid");if(l.exp<=v-m)throw new d.JWTExpired('"exp" claim timestamp check failed',l,"exp","check_failed")}if(s){let a=v-l.iat;if(a-m>("number"==typeof s?s:(0,g.default)(s)))throw new d.JWTExpired('"iat" claim timestamp check failed (too far in the past)',l,"iat","check_failed");if(a<0-m)throw new d.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',l,"iat","check_failed")}return l}},79652:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ConnectedApp=void 0,c(10682);var d=c(37839);class e{constructor(a){this.fetchConfig=a,this.clients=new d.Clients(this.fetchConfig)}}b.ConnectedApp=e},80084:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});var d={B2BClient:!0,Client:!0,SamlShieldClient:!0,envs:!0};Object.defineProperty(b,"B2BClient",{enumerable:!0,get:function(){return e.B2BClient}}),Object.defineProperty(b,"Client",{enumerable:!0,get:function(){return f.Client}}),Object.defineProperty(b,"SamlShieldClient",{enumerable:!0,get:function(){return g.SamlShieldClient}}),b.envs=b.default=void 0;var e=c(30238),f=c(75871),g=c(8237);Object.keys(g).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in b&&b[a]===g[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return g[a]}})});var h=c(97897);Object.keys(h).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in b&&b[a]===h[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return h[a]}})});var i=c(83438);Object.keys(i).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in b&&b[a]===i[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return i[a]}})}),b.envs=k(c(53178));var j=c(65465);function k(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(k=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}Object.keys(j).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in b&&b[a]===j[a]||Object.defineProperty(b,a,{enumerable:!0,get:function(){return j[a]}})}),b.default={Client:f.Client,B2BClient:e.B2BClient,SamlShieldClient:g.SamlShieldClient}},80413:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Secrets=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}rotateStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}/secrets/rotate/start`,headers:{},data:{}})}rotateCancel(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}/secrets/rotate/cancel`,headers:{},data:{}})}rotate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/connected_apps/clients/${encodeURIComponent(a.client_id)}/secrets/rotate`,headers:{},data:{}})}}b.Secrets=e},81078:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(15860),e=c(58515);b.default=(a,b)=>{let c;switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new d.JOSENotSupported(`Content Encryption Algorithm ${a} is not supported either by JOSE or your javascript runtime`)}if(b instanceof Uint8Array){let a=b.byteLength<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}if((0,e.default)(b)&&"secret"===b.type){let a=b.symmetricKeySize<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},81841:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598);b.default=(a,b)=>(0,d.createHash)(a).update(b).digest()},81857:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.GeneralEncrypt=void 0;let d=c(11674),e=c(85167),f=c(15860),g=c(11883),h=c(50215),i=c(63001),j=c(16165),k=c(61801);class l{parent;unprotectedHeader;key;options;constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addRecipient(...a){return this.parent.addRecipient(...a)}encrypt(...a){return this.parent.encrypt(...a)}done(){return this.parent}}class m{_plaintext;_recipients=[];_protectedHeader;_unprotectedHeader;_aad;constructor(a){this._plaintext=a}addRecipient(a,b){let c=new l(this,a,{crit:b?.crit});return this._recipients.push(c),c}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}async encrypt(){let a;if(!this._recipients.length)throw new f.JWEInvalid("at least one recipient must be added");if(1===this._recipients.length){let[a]=this._recipients,b=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(a.unprotectedHeader).encrypt(a.key,{...a.options}),c={ciphertext:b.ciphertext,iv:b.iv,recipients:[{}],tag:b.tag};return b.aad&&(c.aad=b.aad),b.protected&&(c.protected=b.protected),b.unprotected&&(c.unprotected=b.unprotected),b.encrypted_key&&(c.recipients[0].encrypted_key=b.encrypted_key),b.header&&(c.recipients[0].header=b.header),c}for(let b=0;b<this._recipients.length;b++){let c=this._recipients[b];if(!(0,h.default)(this._protectedHeader,this._unprotectedHeader,c.unprotectedHeader))throw new f.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let d={...this._protectedHeader,...this._unprotectedHeader,...c.unprotectedHeader},{alg:e}=d;if("string"!=typeof e||!e)throw new f.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===e||"ECDH-ES"===e)throw new f.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof d.enc||!d.enc)throw new f.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(a){if(a!==d.enc)throw new f.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else a=d.enc;if((0,k.default)(f.JWEInvalid,new Map,c.options.crit,this._protectedHeader,d),void 0!==d.zip)throw new f.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.')}let b=(0,g.default)(a),c={ciphertext:"",iv:"",recipients:[],tag:""};for(let f=0;f<this._recipients.length;f++){let g=this._recipients[f],h={};c.recipients.push(h);let k=({...this._protectedHeader,...this._unprotectedHeader,...g.unprotectedHeader}).alg.startsWith("PBES2")?2048+f:void 0;if(0===f){let a=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(b).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(g.unprotectedHeader).setKeyManagementParameters({p2c:k}).encrypt(g.key,{...g.options,[e.unprotected]:!0});c.ciphertext=a.ciphertext,c.iv=a.iv,c.tag=a.tag,a.aad&&(c.aad=a.aad),a.protected&&(c.protected=a.protected),a.unprotected&&(c.unprotected=a.unprotected),h.encrypted_key=a.encrypted_key,a.header&&(h.header=a.header);continue}let{encryptedKey:l,parameters:m}=await (0,i.default)(g.unprotectedHeader?.alg||this._protectedHeader?.alg||this._unprotectedHeader?.alg,a,g.key,b,{p2c:k});h.encrypted_key=(0,j.encode)(l),(g.unprotectedHeader||m)&&(h.header={...g.unprotectedHeader,...m})}return c}}b.GeneralEncrypt=m},82208:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.performAuthorizationCheck=function({hasScopes:a,requiredScopes:b}){let c={};for(let d of(a.forEach(a=>{let b=a,d="-";a.includes(":")&&([b,d]=a.split(":")),c[b]||(c[b]=new Set),c[b].add(d)}),b)){let a=d,b="-";if(d.includes(":")&&([a,b]=d.split(":")),!c[a])return!1;let e=c[a];if(!e.has("*")&&!e.has(b))return!1}return!0}},82253:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.jwtDecrypt=g;let d=c(5436),e=c(79648),f=c(15860);async function g(a,b,c){let g=await (0,d.compactDecrypt)(a,b,c),h=(0,e.default)(g.protectedHeader,g.plaintext,c),{protectedHeader:i}=g;if(void 0!==i.iss&&i.iss!==h.iss)throw new f.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',h,"iss","mismatch");if(void 0!==i.sub&&i.sub!==h.sub)throw new f.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',h,"sub","mismatch");if(void 0!==i.aud&&JSON.stringify(i.aud)!==JSON.stringify(h.aud))throw new f.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',h,"aud","mismatch");let j={payload:h,protectedHeader:i};return"function"==typeof b?{...j,key:g.key}:j}},82402:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.exportSPKI=g,b.exportPKCS8=h,b.exportJWK=i;let d=c(50452),e=c(50452),f=c(85271);async function g(a){return(0,d.toSPKI)(a)}async function h(a){return(0,e.toPKCS8)(a)}async function i(a){return(0,f.default)(a)}},83438:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0})},84518:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=void 0;var d=c(77598);Object.defineProperty(b,"default",{enumerable:!0,get:function(){return d.randomFillSync}})},84601:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a,b){let c,i,j,k;if(b instanceof d.KeyObject)c=b.asymmetricKeyType,i=b.asymmetricKeyDetails;else switch(j=!0,b.kty){case"RSA":c="rsa";break;case"EC":c="ec";break;case"OKP":if("Ed25519"===b.crv){c="ed25519";break}if("Ed448"===b.crv){c="ed448";break}throw TypeError("Invalid key for this operation, its crv must be Ed25519 or Ed448");default:throw TypeError("Invalid key for this operation, its kty must be RSA, OKP, or EC")}switch(a){case"Ed25519":if("ed25519"!==c)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519");break;case"EdDSA":if(!["ed25519","ed448"].includes(c))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");break;case"RS256":case"RS384":case"RS512":if("rsa"!==c)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,g.default)(b,a);break;case"PS256":case"PS384":case"PS512":if("rsa-pss"===c){let{hashAlgorithm:b,mgf1HashAlgorithm:c,saltLength:d}=i,e=parseInt(a.slice(-3),10);if(void 0!==b&&(b!==`sha${e}`||c!==b))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}`);if(void 0!==d&&d>e>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}`)}else if("rsa"!==c)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");(0,g.default)(b,a),k={padding:d.constants.RSA_PKCS1_PSS_PADDING,saltLength:d.constants.RSA_PSS_SALTLEN_DIGEST};break;case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==c)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let d=(0,e.default)(b),f=h.get(a);if(d!==f)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${f}, got ${d}`);k={dsaEncoding:"ieee-p1363"};break}default:throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}return j?{format:"jwk",key:b,...k}:k?{...k,key:b}:b};let d=c(77598),e=c(26127),f=c(15860),g=c(35884),h=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]])},84925:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Secrets=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}rotateStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}/secrets/rotate/start`,headers:{},data:{}})}rotateCancel(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}/secrets/rotate/cancel`,headers:{},data:{}})}rotate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:`/v1/m2m/clients/${encodeURIComponent(a.client_id)}/secrets/rotate`,headers:{},data:{}})}}b.Secrets=e},85167:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.unprotected=void 0,b.unprotected=Symbol()},85271:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598),e=c(16165),f=c(15860),g=c(28622),h=c(58515),i=c(53738),j=c(59091);b.default=a=>{let b;if((0,g.isCryptoKey)(a)){if(!a.extractable)throw TypeError("CryptoKey is not extractable");b=d.KeyObject.from(a)}else if((0,h.default)(a))b=a;else if(a instanceof Uint8Array)return{kty:"oct",k:(0,e.encode)(a)};else throw TypeError((0,i.default)(a,...j.types,"Uint8Array"));if("secret"!==b.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(b.asymmetricKeyType))throw new f.JOSENotSupported("Unsupported key asymmetricKeyType");return b.export({format:"jwk"})}},85733:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(63400),e=c(22725),f=c(26279),g=c(27931),h=c(16165),i=c(70466),j=c(15860),k=c(11883),l=c(18681),m=c(91181),n=c(17600),o=c(58154);b.default=async function(a,b,c,p,q){switch((0,m.default)(a,b,"decrypt"),b=await i.default.normalizePrivateKey?.(b,a)||b,a){case"dir":if(void 0!==c)throw new j.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new j.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let f,g;if(!(0,n.default)(p.epk))throw new j.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!e.ecdhAllowed(b))throw new j.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let i=await (0,l.importJWK)(p.epk,a);if(void 0!==p.apu){if("string"!=typeof p.apu)throw new j.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{f=(0,h.decode)(p.apu)}catch{throw new j.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==p.apv){if("string"!=typeof p.apv)throw new j.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{g=(0,h.decode)(p.apv)}catch{throw new j.JWEInvalid("Failed to base64url decode the apv")}}let m=await e.deriveKey(i,b,"ECDH-ES"===a?p.enc:a,"ECDH-ES"===a?(0,k.bitLength)(p.enc):parseInt(a.slice(-5,-2),10),f,g);if("ECDH-ES"===a)return m;if(void 0===c)throw new j.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a.slice(-6),m,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new j.JWEInvalid("JWE Encrypted Key missing");return(0,g.decrypt)(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let d;if(void 0===c)throw new j.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof p.p2c)throw new j.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let e=q?.maxPBES2Count||1e4;if(p.p2c>e)throw new j.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof p.p2s)throw new j.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{d=(0,h.decode)(p.p2s)}catch{throw new j.JWEInvalid("Failed to base64url decode the p2s")}return(0,f.decrypt)(a,b,c,p.p2c,d)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new j.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let d,e;if(void 0===c)throw new j.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof p.iv)throw new j.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof p.tag)throw new j.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{d=(0,h.decode)(p.iv)}catch{throw new j.JWEInvalid("Failed to base64url decode the iv")}try{e=(0,h.decode)(p.tag)}catch{throw new j.JWEInvalid("Failed to base64url decode the tag")}return(0,o.unwrap)(a,b,c,d,e)}default:throw new j.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}},86112:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.request=e;var d=c(65465);async function e(a,b){let c,e,f="FRAUD"==b.baseURLType?a.fraudBaseURL:a.baseURL,g=new URL(b.url,f);b.params&&Object.entries(b.params).forEach(([a,b])=>{void 0!==b&&g.searchParams.append(a,String(b))});let h={...a.headers,...b.headers};try{let d=b.data?JSON.stringify(b.data):b.dataRaw;c=await fetch(g.toString(),{method:b.method,body:d,cache:"no-store",...a,headers:h})}catch(a){throw new d.RequestError(a.message,b)}try{e=await c.json()}catch(a){throw new d.RequestError(`Unable to parse JSON response from server: ${a.message}`,b)}if(c.status>=400)throw new d.StytchError(e);return e}},86568:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OTPs=void 0,c(10682);var d=c(42079),e=c(54510);class f{constructor(a){this.fetchConfig=a,this.sms=new e.Sms(this.fetchConfig),this.email=new d.Email(this.fetchConfig)}}b.OTPs=f},86786:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.OAuth=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authorizeStart(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/idp/oauth/authorize/start",headers:{},data:a})}authorize(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/idp/oauth/authorize",headers:{},data:a})}}b.OAuth=e},87520:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Fraud=void 0,c(10682);var d=c(31075),e=c(3016),f=c(28400);class g{constructor(a){this.fetchConfig=a,this.fingerprint=new d.Fingerprint(this.fetchConfig),this.rules=new e.Rules(this.fetchConfig),this.verdictReasons=new f.VerdictReasons(this.fetchConfig)}}b.Fraud=g},88504:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Sms=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}send(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/sms/send",headers:{},data:a})}loginOrCreate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/otps/sms/login_or_create",headers:{},data:a})}}b.Sms=e},90951:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Discovery=void 0,c(10682);var d=c(86112);class e{constructor(a){this.fetchConfig=a}authenticate(a){return(0,d.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/oauth/discovery/authenticate",headers:{},data:a})}}b.Discovery=e},91016:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.Email=void 0;var d=c(10682),e=c(86112);class f{constructor(a){this.fetchConfig=a}resetStart(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/email/reset/start",headers:{},data:a})}reset(a){return(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/email/reset",headers:{},data:a})}requireReset(a,b){let c={};return b?.authorization&&(0,d.addAuthorizationHeaders)(c,b.authorization),(0,e.request)(this.fetchConfig,{method:"POST",url:"/v1/b2b/passwords/email/require_reset",headers:c,data:a})}}b.Email=f},91136:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0});let d=c(77598),e=c(57975),f=c(92956),g=c(70409),h=c(84601),i=c(91289),j=(0,e.promisify)(d.sign);b.default=async(a,b,c)=>{let e=(0,i.default)(a,b,"sign");if(a.startsWith("HS")){let b=d.createHmac((0,g.default)(a),e);return b.update(c),b.digest()}return j((0,f.default)(a),c,(0,h.default)(a,e))}},91181:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.checkKeyTypeWithJwk=void 0;let d=c(53738),e=c(59091),f=c(44631),g=a=>a?.[Symbol.toStringTag],h=(a,b,c)=>{if(void 0!==b.use&&"sig"!==b.use)throw TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==b.key_ops&&b.key_ops.includes?.(c)!==!0)throw TypeError(`Invalid key for this operation, when present its key_ops must include ${c}`);if(void 0!==b.alg&&b.alg!==a)throw TypeError(`Invalid key for this operation, when present its alg must be ${a}`);return!0};function i(a,b,c,i){b.startsWith("HS")||"dir"===b||b.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(b)?((a,b,c,i)=>{if(!(b instanceof Uint8Array)){if(i&&f.isJWK(b)){if(f.isSecretJWK(b)&&h(a,b,c))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types,"Uint8Array",i?"JSON Web Key":null));if("secret"!==b.type)throw TypeError(`${g(b)} instances for symmetric algorithms must be of type "secret"`)}})(b,c,i,a):((a,b,c,i)=>{if(i&&f.isJWK(b))switch(c){case"sign":if(f.isPrivateJWK(b)&&h(a,b,c))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(f.isPublicJWK(b)&&h(a,b,c))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types,i?"JSON Web Key":null));if("secret"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithm decryption must be of type "private"`);if(b.algorithm&&"verify"===c&&"private"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithm verifying must be of type "public"`);if(b.algorithm&&"encrypt"===c&&"private"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithm encryption must be of type "public"`)})(b,c,i,a)}b.default=i.bind(void 0,!1),b.checkKeyTypeWithJwk=i.bind(void 0,!0)},91289:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError((0,g.default)(b,...h.types));return(0,d.createSecretKey)(b)}if(b instanceof d.KeyObject)return b;if((0,e.isCryptoKey)(b))return(0,f.checkSigCryptoKey)(b,a,c),d.KeyObject.from(b);if(i.isJWK(b))return a.startsWith("HS")?(0,d.createSecretKey)(Buffer.from(b.k,"base64url")):b;throw TypeError((0,g.default)(b,...h.types,"Uint8Array","JSON Web Key"))};let d=c(77598),e=c(28622),f=c(92749),g=c(53738),h=c(59091),i=c(44631)},92749:(a,b)=>{function c(a,b="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`)}function d(a,b){return a.name===b}function e(a){return parseInt(a.name.slice(4),10)}function f(a,b){if(b.length&&!b.some(b=>a.usages.includes(b))){let a="CryptoKey does not support this operation, its usages must include ";if(b.length>2){let c=b.pop();a+=`one of ${b.join(", ")}, or ${c}.`}else 2===b.length?a+=`one of ${b[0]} or ${b[1]}.`:a+=`${b[0]}.`;throw TypeError(a)}}Object.defineProperty(b,"__esModule",{value:!0}),b.checkSigCryptoKey=function(a,b,...g){switch(b){case"HS256":case"HS384":case"HS512":{if(!d(a.algorithm,"HMAC"))throw c("HMAC");let f=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==f)throw c(`SHA-${f}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!d(a.algorithm,"RSASSA-PKCS1-v1_5"))throw c("RSASSA-PKCS1-v1_5");let f=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==f)throw c(`SHA-${f}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!d(a.algorithm,"RSA-PSS"))throw c("RSA-PSS");let f=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==f)throw c(`SHA-${f}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==a.algorithm.name&&"Ed448"!==a.algorithm.name)throw c("Ed25519 or Ed448");break;case"Ed25519":if(!d(a.algorithm,"Ed25519"))throw c("Ed25519");break;case"ES256":case"ES384":case"ES512":{if(!d(a.algorithm,"ECDSA"))throw c("ECDSA");let e=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==e)throw c(e,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}f(a,g)},b.checkEncCryptoKey=function(a,b,...g){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if(!d(a.algorithm,"AES-GCM"))throw c("AES-GCM");let e=parseInt(b.slice(1,4),10);if(a.algorithm.length!==e)throw c(e,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!d(a.algorithm,"AES-KW"))throw c("AES-KW");let e=parseInt(b.slice(1,4),10);if(a.algorithm.length!==e)throw c(e,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw c("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!d(a.algorithm,"PBKDF2"))throw c("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!d(a.algorithm,"RSA-OAEP"))throw c("RSA-OAEP");let f=parseInt(b.slice(9),10)||1;if(e(a.algorithm.hash)!==f)throw c(`SHA-${f}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}f(a,g)}},92956:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=function(a){switch(a){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"Ed25519":case"EdDSA":return;default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}};let d=c(15860)},93383:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.authenticateJwtLocal=g,b.authenticateM2MJwtLocal=h,b.authenticateSessionJwtLocal=i,b.trimTrailingSlash=function(a){for(;a.endsWith("/");)a=a.slice(0,-1);return a};var d=f(c(57398)),e=c(65465);function f(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(f=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=typeof a&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(let b in a)"default"!==b&&({}).hasOwnProperty.call(a,b)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,b))&&(f.get||f.set)?e(g,b,f):g[b]=a[b]);return g})(a,b)}async function g(a,b,c,f){let g,h=f?.current_date||new Date;try{g=(await d.jwtVerify(c,a,{...b,clockTolerance:f?.clock_tolerance_seconds,currentDate:h})).payload}catch(a){throw new e.ClientError("jwt_invalid","Could not verify JWT",a)}let i=f?.max_token_age_seconds;if(null!=i){let a=g.iat;if(!a)throw new e.ClientError("jwt_invalid","JWT was missing iat claim");if(h/1e3-a>=i)throw new e.ClientError("jwt_too_old",`JWT was issued at ${a}, more than ${i} seconds ago`)}let{aud:j,exp:k,iat:l,iss:m,jti:n,nbf:o,sub:p,...q}=g;return{payload:g,customClaims:q}}async function h(a,b,c,d){let{payload:e,customClaims:f}=await g(a,b,c,d),{scope:h,...i}=f;return{sub:e.sub??"",scope:h,custom_claims:i}}async function i(a,b,c,d){let{payload:e,customClaims:f}=await g(a,b,c,d),{"https://stytch.com/session":h,...i}=f;return{session_id:h.id,attributes:h.attributes,authentication_factors:h.authentication_factors,sub:e.sub||"",started_at:h.started_at,last_accessed_at:h.last_accessed_at,expires_at:new Date(h.expires_at||1e3*(e.exp||0)).toISOString(),custom_claims:i,roles:h.roles}}},96361:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PolicyCache=void 0,b.performAuthorizationCheck=function({policy:a,subjectRoles:b,subjectOrgID:c,authorizationCheck:f}){if(c!==f.organization_id)throw new d.ClientError("tenancy_mismatch","Member belongs to different organization");(0,e.performBaseRoleAuthorizationCheck)({policy:a,subjectRoles:b,authorizationCheck:f,callerType:"Member"})},b.performScopeAuthorizationCheck=function({policy:a,tokenScopes:b,subjectOrgID:c,authorizationCheck:f}){if(c!==f.organization_id)throw new d.ClientError("tenancy_mismatch","Member belongs to different organization");return(0,e.performBaseScopeAuthorizationCheck)({policy:a,tokenScopes:b,authorizationCheck:f,callerType:"Member"})};var d=c(65465),e=c(74618);class f extends e.BasePolicyCache{}b.PolicyCache=f},96591:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.default=(a,b)=>{if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}},97343:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.FlattenedSign=void 0;let d=c(16165),e=c(91136),f=c(50215),g=c(15860),h=c(49616),i=c(91181),j=c(61801);class k{_payload;_protectedHeader;_unprotectedHeader;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=a}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}async sign(a,b){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new g.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,f.default)(this._protectedHeader,this._unprotectedHeader))throw new g.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let k={...this._protectedHeader,...this._unprotectedHeader},l=(0,j.default)(g.JWSInvalid,new Map([["b64",!0]]),b?.crit,this._protectedHeader,k),m=!0;if(l.has("b64")&&"boolean"!=typeof(m=this._protectedHeader.b64))throw new g.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:n}=k;if("string"!=typeof n||!n)throw new g.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,i.checkKeyTypeWithJwk)(n,a,"sign");let o=this._payload;m&&(o=h.encoder.encode((0,d.encode)(o))),c=this._protectedHeader?h.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):h.encoder.encode("");let p=(0,h.concat)(c,h.encoder.encode("."),o),q=await (0,e.default)(n,a,p),r={signature:(0,d.encode)(q),payload:""};return m&&(r.payload=h.decoder.decode(o)),this._unprotectedHeader&&(r.header=this._unprotectedHeader),this._protectedHeader&&(r.protected=h.decoder.decode(c)),r}}b.FlattenedSign=k},97897:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0})},98946:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.CompactSign=void 0;let d=c(97343);class e{_flattened;constructor(a){this._flattened=new d.FlattenedSign(a)}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}async sign(a,b){let c=await this._flattened.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}b.CompactSign=e}};